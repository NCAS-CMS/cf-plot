<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>cf-plot user guide &#8212; cf-plot 3.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=97decc96" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    
    <script src="_static/documentation_options.js?v=3eb8911e"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">cf-plot 3.3.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">cf-plot user guide</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="cf-plot-user-guide">
<h1>cf-plot user guide<a class="headerlink" href="#cf-plot-user-guide" title="Link to this heading">¶</a></h1>
<p><strong>Contents</strong></p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#introduction">introduction</a> to cf-plot</div>
<div class="line"><a class="reference internal" href="#access">access</a> - where cf-plot is installed and how to install it</div>
<div class="line"><br /></div>
<div class="line"><a class="reference internal" href="#contours">contours</a> - making contour plots</div>
<div class="line"><a class="reference internal" href="#vectors">vectors</a> - plotting vectors</div>
<div class="line"><a class="reference internal" href="#multiple">multiple</a>  plots on a page and plot positioning</div>
<div class="line"><a class="reference internal" href="#trajectories">trajectories</a> - plotting trajectories</div>
<div class="line"><a class="reference internal" href="#significance">significance</a> - plots</div>
<div class="line"><a class="reference internal" href="#graphs">graphs</a> - making graphs</div>
<div class="line"><a class="reference internal" href="#colour">colour</a> scales - using and changing colour scales</div>
<div class="line"><br /></div>
<div class="line"><a class="reference internal" href="#appendixa">appendixA</a> - introduction to cf-python</div>
<div class="line"><a class="reference internal" href="#appendixb">appendixB</a> - passing data via arrays</div>
<div class="line"><a class="reference internal" href="#appendixc">appendixC</a> - map projections and options</div>
<div class="line"><a class="reference internal" href="#appendixd">appendixD</a> - fixing data to be more cf-compliant</div>
</div>
<section id="introduction">
<span id="id1"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>cf-plot is a set of Python functions for making common contour, vector and line plots that climate researchers use. cf-plot generally uses <a class="reference external" href="https://ncas-cms.github.io/cf-python">cf-python</a> to present the data and CF attributes for plotting.  It can also use numpy arrays of data as the input fields making for flexible plotting of data.  cf-plot uses the Python numpy, matplotlib and scipy libraries.</p>
<p>At the core of cf-plot are a set of functions for making and controlling plots.</p>
<div class="line-block">
<div class="line"><strong>Plot making operators</strong></div>
<div class="line"><a class="reference internal" href="con.html#con"><span class="std std-ref">con</span></a>  - make a contour plot</div>
<div class="line"><a class="reference internal" href="cbar.html#cbar"><span class="std std-ref">cbar</span></a>  - make a colour bar</div>
<div class="line"><a class="reference internal" href="vect.html#vect"><span class="std std-ref">vect</span></a> - vector and stream plots</div>
<div class="line"><a class="reference internal" href="traj.html#traj"><span class="std std-ref">traj</span></a>  - trajectory plots</div>
<div class="line"><a class="reference internal" href="lineplot.html#lineplot"><span class="std std-ref">lineplot</span></a>  - make a graph</div>
<div class="line"><a class="reference internal" href="stipple.html#stipple"><span class="std std-ref">stipple</span></a>  - make a stipple plot</div>
</div>
<div class="line-block">
<div class="line"><strong>Plot control operators</strong></div>
<div class="line"><a class="reference internal" href="gopen.html#gopen"><span class="std std-ref">gopen</span></a> - open a plot</div>
<div class="line"><a class="reference internal" href="gclose.html#gclose"><span class="std std-ref">gclose</span></a> - close a plot</div>
<div class="line"><a class="reference internal" href="gpos.html#gpos"><span class="std std-ref">gpos</span></a> - plot positioning</div>
<div class="line"><a class="reference internal" href="gset.html#gset"><span class="std std-ref">gset</span></a>  - set non map plotting region</div>
<div class="line"><a class="reference internal" href="levs.html#levs"><span class="std std-ref">levs</span></a>  - define contour levels</div>
<div class="line"><a class="reference internal" href="cscale.html#cscale"><span class="std std-ref">cscale</span></a>  - select and change colour scales</div>
<div class="line"><a class="reference internal" href="mapset.html#mapset"><span class="std std-ref">mapset</span></a>  - set mapping parameters</div>
<div class="line"><a class="reference internal" href="reset.html#reset"><span class="std std-ref">reset</span></a> - reset all plot parameters</div>
<div class="line"><a class="reference internal" href="setvars.html#setvars"><span class="std std-ref">setvars</span></a> - set a variety of plot parameters</div>
</div>
<p>This user guide is a set of examples of plots that climate scientists generally make.  Further details and fine tuning options are available by looking at the individual function documentation above.</p>
</section>
<section id="where-cf-plot-is-installed-and-how-to-install-it">
<span id="access"></span><h2>Where cf-plot is installed and how to install it<a class="headerlink" href="#where-cf-plot-is-installed-and-how-to-install-it" title="Link to this heading">¶</a></h2>
<p>cf-python and cf-plot are pre-installed on the following platforms.</p>
<div class="line-block">
<div class="line"><strong>Jasmin super-data-cluster</strong></div>
<div class="line">export PATH=/home/users/ajh/anaconda3/bin:$PATH</div>
<div class="line">ln -s /home/users/ajh/cfplot_data ~</div>
</div>
<div class="line-block">
<div class="line"><strong>Archer supercomputer in Edinburgh</strong></div>
<div class="line">export PATH=/home/n02/n02/ajh/anaconda3/bin:$PATH</div>
<div class="line">ln -s /home/n02/n02/ajh/cfplot_data ~</div>
</div>
<div class="line-block">
<div class="line"><strong>Reading University RACC cluster</strong></div>
<div class="line">module load ncas_anaconda3</div>
<div class="line">ln -s /share/apps/NCAS/cfplot_data ~</div>
</div>
<p>For other platforms follow the <a class="reference internal" href="download.html#download"><span class="std std-ref">cf-plot installation instructions</span></a></p>
</section>
<section id="contour-plots">
<span id="contours"></span><h2>Contour plots<a class="headerlink" href="#contour-plots" title="Link to this heading">¶</a></h2>
<p>The following examples use cf-python to present the data to cf-plot.  The syntax is quite simple and can be learned as the examples progress.  A fuller discussion of using cf-python to manipulate data is available in <a class="reference internal" href="#appendixa">appendixA</a>.  If you have numpy arrays that you wish to plot then look in <a class="reference internal" href="#appendixb">appendixB</a> for a couple of examples of how to do this.</p>
<p>The data to make a contour plot can be read in and passed to cf-plot using cf-python as per the following example.</p>
<section id="cylindrical-projection">
<h3>Cylindrical projection<a class="headerlink" href="#cylindrical-projection" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig1.png"><img alt="_images/fig1.png" src="_images/fig1.png" style="width: 514.28px; height: 313.56px;" /></a>
<p>Note that for a contour plot two dimensional data is required.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<p>&lt;CF Field: air_temperature(time(1), latitude(73), longitude(96)) K&gt;</p>
<p>Dimensions that have one element, such as time in this instance, are ignored.</p>
<p>The <strong>cfp.mapset</strong> routine is used to change the map area and projection.
<strong>cfp.mapset(lonmin=-15, lonmax=3, latmin=48, latmax=60)</strong> sets the map to a view over the British Isles. The cfp.mapset command is persistent in that any further map plots will use the same map projection and limits without having to specify the same map again.  The levels are taken from the whole field and in this example we specify the levels explicitly with the <strong>cfp.levs</strong> command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">lonmin</span><span class="o">=-</span><span class="mi">15</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">latmin</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">latmax</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">265</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">285</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig3.png"><img alt="_images/fig3.png" src="_images/fig3.png" style="width: 487.24px; height: 328.12px;" /></a>
<p>The default settings are for colour fill with contour lines over the top.  These can be changed with the <strong>fill=False</strong> and <strong>lines=False</strong> flags to <strong>cfp.con</strong>.</p>
<p>To reset the mapping to the default cylindrical projection -180 to 180 in longitude and -90 to 90 in latitude use <strong>cfp.mapset()</strong>.  Likewise to reset the contour levels use <strong>cfp.levs()</strong>.</p>
</section>
<section id="blockfill-plots">
<h3>Blockfill plots<a class="headerlink" href="#blockfill-plots" title="Link to this heading">¶</a></h3>
<p>Blockfill plots in the cylindrical projection are made using the <strong>blockfill=True</strong> flag to the <strong>cfp.con</strong> routine.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span> <span class="n">blockfill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig2.png"><img alt="_images/fig2.png" src="_images/fig2.png" style="width: 514.28px; height: 313.56px;" /></a>
</section>
<section id="polar-stereographic-plots">
<h3>Polar stereographic plots<a class="headerlink" href="#polar-stereographic-plots" title="Link to this heading">¶</a></h3>
<p>Polar Stereographic plots are set using <strong>proj='npstere'</strong> or <strong>proj='spstere'</strong> in the call to <strong>cfp.mapset</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;npstere&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig4.png"><img alt="_images/fig4.png" src="_images/fig4.png" style="width: 439.92px; height: 387.40000000000003px;" /></a>
<p>The <strong>mapset</strong> <strong>bounding_lat</strong> and <strong>lon_0</strong> parameters are used to set the latitude limit of the plot and the orientation of the plot. Generally for the southern hemisphere the Greenwich Meridian (zero degrees longitude) is plotted at the top of the plot and is set with <strong>lon_0=0</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;spstere&#39;</span><span class="p">,</span> <span class="n">boundinglat</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig5.png"><img alt="_images/fig5.png" src="_images/fig5.png" style="width: 438.88px; height: 384.28000000000003px;" /></a>
</section>
<section id="latitude-pressure-plots">
<h3>Latitude - Pressure Plots<a class="headerlink" href="#latitude-pressure-plots" title="Link to this heading">¶</a></h3>
<p>The latitude-pressure plot below is made by using the cf subspace method to select the temperature at longitude=0 degrees.  Again this data has two dimensions with multiple values in.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>&lt;CF Field: air_temperature(time(1), pressure(23), latitude(160), longitude(1)) K&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig6.png"><img alt="_images/fig6.png" src="_images/fig6.png" style="width: 530.9200000000001px; height: 346.84000000000003px;" /></a>
<p>A mean of the data along the longitude (zonal mean) is made using the cf.collapse method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig7.png"><img alt="_images/fig7.png" src="_images/fig7.png" style="width: 530.9200000000001px; height: 346.84000000000003px;" /></a>
<p>To make a log pressure on the y axis use the ylog=True flag to the con routine.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">),</span> <span class="n">ylog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig8.png"><img alt="_images/fig8.png" src="_images/fig8.png" style="width: 530.9200000000001px; height: 346.84000000000003px;" /></a>
</section>
<section id="hovmuller-plots">
<h3>Hovmuller plots<a class="headerlink" href="#hovmuller-plots" title="Link to this heading">¶</a></h3>
<p>A Hovmuller plot is one of longitude or latitude versus time as in the following examples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;plasma&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig10.png"><img alt="_images/fig10.png" src="_images/fig10.png" style="width: 530.9200000000001px; height: 344.76px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gset</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;1960-1-1&#39;</span><span class="p">,</span> <span class="s1">&#39;1980-1-1&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">280</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">305</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;plasma&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig11.png"><img alt="_images/fig11.png" src="_images/fig11.png" style="width: 530.4px; height: 345.28000000000003px;" /></a>
</section>
<section id="vector-and-stream-plots">
<span id="vectors"></span><h3>Vector and stream Plots<a class="headerlink" href="#vector-and-stream-plots" title="Link to this heading">¶</a></h3>
<p>Vector plots are made using the <strong>cfp.vect</strong> routine.  The u and v data must have two dimensions with matching multiple values in as below.</p>
<div class="line-block">
<div class="line">&lt;CF Field: eastward_wind(time(1), pressure(1), latitude(160), longitude(320)) m s**-1&gt;</div>
<div class="line">&lt;CF Field: northward_wind(time(1), pressure(1), latitude(160), longitude(320)) m s**-1&gt;</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)</span>
<span class="n">u</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">v</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">vect</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">key_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig13.png"><img alt="_images/fig13.png" src="_images/fig13.png" style="width: 514.28px; height: 264.68px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>The <strong>key_length</strong> parameter sets the length of the reference key.  The scale parameter sets the viewable length of the vector with <strong>scale=50</strong> producing vectors that look twice as long as <strong>scale=100</strong>.  There are often too many vectors on the plot giving a mostly black set of lines.  The <strong>stride=5</strong> option helps with this and will plot only every 5th vector location in x and y.  There is also an alternative <strong>npts</strong> parameter that can be user to interpolate the data to this number of points in x and y.</p>
<p>In this example vectors are overlaid on a contour plot. Usually a plot is displayed immediately after making a <strong>cfp.con</strong> or <strong>cfp.vect</strong> command.  As we want a vector plot on top of a contour plot we need to open a graphics file file <strong>cfp.gopen()</strong> make our contour and vector plots with <strong>cfp.con</strong> and <strong>cfp.vect</strong> and then close the graphics file with <strong>cfp.gclose()</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)</span>
<span class="n">u</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">v</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">t</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">()</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">lonmin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">latmin</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">latmax</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">254</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">vect</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">key_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig14.png"><img alt="_images/fig14.png" src="_images/fig14.png" style="width: 516.88px; height: 325.0px;" /></a>
<p>Here we make a zonal mean vector plot with different vector keys and scaling factors for the X and Y directions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>

<span class="n">c</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/vaAMIPlcd_DJF.nc&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Y</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span>
<span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">160</span><span class="p">))</span>
<span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: mean X: mean&#39;</span><span class="p">)</span>

<span class="n">g</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/wapAMIPlcd_DJF.nc&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Y</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span>
<span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="mi">160</span><span class="p">))</span>
<span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: mean X: mean&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">vect</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="o">=-</span><span class="n">g</span><span class="p">,</span> <span class="n">key_length</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
         <span class="n">stride</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">headwidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
         <span class="n">headaxislength</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span>
         <span class="n">key_location</span><span class="o">=</span><span class="p">[</span><span class="mf">0.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig16.png"><img alt="_images/fig16.png" src="_images/fig16.png" style="width: 456.72px; height: 352.44px;" /></a>
<p>A streamplot is used to show fluid flow and 2D field gradients.  In this first example the data goes from 0 to 358.875 in longitude.  The cartopy / matplotlib interface seems to need the data to be inside the data window in longitude so we anchor the data in cf-python using the anchor method to start at -180 in longitude.  If we didn't do this any longitudes less than zero would have no streams drawn.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">anchor</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">anchor</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig16b.png"><img alt="_images/fig16b.png" src="_images/fig16b.png" style="width: 435.16px; height: 218.68px;" /></a>
<p>In the second streamplot example a colorbar showing the intensity of the wind is drawn.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">magnitude</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
<span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">magnitude</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">()</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mag</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cbar</span><span class="p">(</span><span class="n">levs</span><span class="o">=</span><span class="n">cfp</span><span class="o">.</span><span class="n">plotvars</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Wind magnitude&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig16c.png"><img alt="_images/fig16c.png" src="_images/fig16c.png" style="width: 435.16px; height: 270.6px;" /></a>
</section>
<section id="multiple-plots-on-a-page-and-plot-positioning">
<span id="multiple"></span><h3>Multiple plots on a page and plot positioning<a class="headerlink" href="#multiple-plots-on-a-page-and-plot-positioning" title="Link to this heading">¶</a></h3>
<p>To make multiple plots on the page open a graphic file with <strong>cfp.gopen</strong> and pass the rows and columns parameters. Make each plot in turn first selecting the position with <strong>cfp.gpos()</strong>.  The first position is the top left plot and increases by one for one plot to the right until the final plot is made in the bottom right. When all the plots have been made close the plot with <strong>cfp.gclose()</strong>.  A combined colour bar is also made as all the plots have the same contour levels and colour scale helping to reduce the plot complexity.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gpos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gpos</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;moll&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gpos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;npstere&#39;</span><span class="p">,</span> <span class="n">boundinglat</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gpos</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;spstere&#39;</span><span class="p">,</span> <span class="n">boundinglat</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colorbar_position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">],</span>
        <span class="n">colorbar_orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig19.png"><img alt="_images/fig19.png" src="_images/fig19.png" style="width: 508.04px; height: 367.64px;" /></a>
<p>Plot spacing options are located in <strong>cfp.gopen</strong></p>
<div class="line-block">
<div class="line">orientation='landscape' - orientation - also takes 'portrait'</div>
<div class="line">figsize=[11.7, 8.3]  - figure size in inches</div>
<div class="line">left=None - left margin in normalised coordinates - default=0.12</div>
<div class="line">right=None - right margin in normalised coordinates - default=0.92</div>
<div class="line">top=None - top margin in normalised coordinates - default=0.08</div>
<div class="line">bottom=None - bottom margin in normalised coordinates - default=0.08</div>
<div class="line">wspace=None - width reserved for blank space between subplots - default=0.2</div>
<div class="line">hspace=None - height reserved for white space between subplots - default=0.2</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><a href="#id2"><span class="problematic" id="id3">|</span></a>and color bar spacings in <strong>cfp.cbar</strong>.
|
| orientation - orientation 'horizontal' or 'vertical'
| position - user specified colorbar position in normalised
|            plot coordinates [left, bottom, width, height]
| shrink - default=1.0 - scale colorbar along length
| fraction - default = 0.21 - space for the colorbar in
|            normalised plot coordinates
| thick - set height of colorbar - default = 0.015,
|         in normalised plot coordinates
| anchor - default=0.3 - anchor point of colorbar within the fraction space.
|                        0.0 = close to plot, 1.0 = further away
|
|</p>
<p>When making map plots the default setting is for one degree of longitude to be the same size as
one degree of longitude on the plot.  This will make some plots smaller than the area allocated
to them as the plot size will be changed to fit within the plot area.  The aspect option to
<strong>cfp.mapset</strong> can be used to change the aspect ratio if desired.</p>
<div class="line-block">
<div class="line">aspect = 'equal' - the default, 1 degree longitude is the same size as one degree of latitude</div>
<div class="line">aspect = 'auto'  - map fills the plot area</div>
<div class="line">aspect = number  - a circle will be stretched such that the height is num times the width.</div>
<div class="line-block">
<div class="line">aspect=1 is the same as aspect='equal'.</div>
</div>
</div>
<p>User specified plot limits are set by first specifying the <strong>user_position=True</strong> parameter to
<strong>cfp.gopen</strong> and then the plot position to the gpos routines.  The <strong>xmin, xmax, ymin, ymax</strong>
paramenters for the plot display area are in plot extent normalised coordinates. These are 0.0
for bottom or left and 1.0 for top or right of the plot area.</p>
<p>Cylidrical projection plots have an additional rider of having a degree in longitude and latitude
being the same size so plots of this type might not fill the plot area specified as expected.</p>
<a class="reference internal image-reference" href="_images/fig19a.png"><img alt="_images/fig19a.png" src="_images/fig19a.png" style="width: 430.32px; height: 289.96px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">(</span><span class="n">user_position</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gpos</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;500mb&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gpos</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;100mb&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gpos</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;10mb&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
<p>The indication that the plot position on the page is to be set manually is made with the
<strong>user_position=True</strong> parameter to <strong>cfp.gopen</strong>. The required plot position is set in <strong>cfp.gpos</strong>
with the <strong>xmin, xmax, ymin, ymax</strong> parameters.  Two calls to the <strong>cfp.cbar</strong> routine then place
colour bars on the plot with different colour scales and contour levels.</p>
<a class="reference internal image-reference" href="_images/fig19b.png"><img alt="_images/fig19b.png" src="_images/fig19b.png" style="width: 399.52px; height: 286.88px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">g</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: mean&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">(</span><span class="n">user_position</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gpos</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Zonal mean zonal wind at 100mb&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;seaice_2&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">levs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">282</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cbar</span><span class="p">(</span><span class="n">levs</span><span class="o">=</span><span class="n">levs</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;seaice_2&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;topo_15lev&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="n">levs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cbar</span><span class="p">(</span><span class="n">levs</span><span class="o">=</span><span class="n">levs</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;topo_15lev&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="trajectories">
<span id="id4"></span><h3>Trajectories<a class="headerlink" href="#trajectories" title="Link to this heading">¶</a></h3>
<p>Data stored in contiguous ragged array format, such as from Kevin Hodges's TRACK program, can be plotted using cf-plot using <strong>cfp.traj</strong>.</p>
<a class="reference internal image-reference" href="_images/fig39.png"><img alt="_images/fig39.png" src="_images/fig39.png" style="width: 514.28px; height: 258.96000000000004px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ff_trs_pos.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">traj</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</section>
<section id="stipple-plots">
<span id="significance"></span><h3>Stipple plots<a class="headerlink" href="#stipple-plots" title="Link to this heading">¶</a></h3>
<p>A stipple plot is usually used to show areas of significance such as 95% or greater confidence. These plots use the overlay technique as used in the previous contour/vector plot.  In these plots we show a coutour plot and a stipple plot between varous contour levels to show that the stippling works correctly.  For different significance levels such as confidences of 95% and 99% chosing a different sized or colour marker is a common plot technique.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">g</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">()</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">stipple</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">220</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">260</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00ff00&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">stipple</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">330</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0000ff&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig17.png"><img alt="_images/fig17.png" src="_images/fig17.png" style="width: 514.28px; height: 313.56px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">g</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">()</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;npstere&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">stipple</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">265</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">295</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#00ff00&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig18.png"><img alt="_images/fig18.png" src="_images/fig18.png" style="width: 440.96000000000004px; height: 387.40000000000003px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</section>
<section id="graph-plots">
<span id="graphs"></span><h3>Graph plots<a class="headerlink" href="#graph-plots" title="Link to this heading">¶</a></h3>
<p>To make a graph plot use the <strong>cfp.lineplot</strong> function as below on a single line of data in a field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">g</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: mean&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Zonal mean zonal wind at 100mb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig27.png"><img alt="_images/fig27.png" src="_images/fig27.png" style="width: 516.36px; height: 399.88px;" /></a>
<div class="line-block">
<div class="line">Other valid markers are:</div>
<div class="line">'.' point</div>
<div class="line">',' pixel</div>
<div class="line">'o' circle</div>
<div class="line">'v' triangle_down</div>
<div class="line">'^' triangle_up</div>
<div class="line">'&lt;' triangle_left</div>
<div class="line">'&gt;' triangle_right</div>
<div class="line">'1' tri_down</div>
<div class="line">'2' tri_up</div>
<div class="line">'3' tri_left</div>
<div class="line">'4' tri_right</div>
<div class="line">'8' octagon</div>
<div class="line">'s' square</div>
<div class="line">'p' pentagon</div>
<div class="line">'*' star</div>
<div class="line">'h' hexagon1</div>
<div class="line">'H' hexagon2</div>
<div class="line">'+' plus</div>
<div class="line">'x' x</div>
<div class="line">'D' diamond</div>
<div class="line">'d' thin_diamond</div>
</div>
<p>To make a multiple line plot use the gopen, gclose commands to enclose the plotting commands as in the example below.</p>
<div class="line-block">
<div class="line">When making a multiple line plot:</div>
<div class="line">a) Set the axis limits if required with <strong>cfp.gset</strong> before plotting the lines.</div>
<div class="line-block">
<div class="line">Using <strong>cfp.gset</strong> after the last line has been plotted may give unexpected axis</div>
<div class="line">limits and / or labelling.  This is a feature of Matplotlib.</div>
</div>
<div class="line">b) The last call to <strong>cfp.lineplot</strong> is the one that any of axis labelling overrides should be placed in.</div>
<div class="line">c) All calls to <strong>cfp.lineplot</strong> with the <strong>label</strong> attribute set will appear in the legend.</div>
<div class="line">d) When plotting time data from different models set the time units to be the same as the first line plotted to</div>
<div class="line-block">
<div class="line">avoid different time axes being used i.e.</div>
<div class="line"><strong>cfp.lineplot(f)</strong></div>
<div class="line"><strong>g.coord('T').units = f.coord('T').units</strong></div>
<div class="line"><strong>cfp.lineplot(g)</strong></div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">g</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: mean&#39;</span><span class="p">)</span>
<span class="n">xticks</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">90</span><span class="p">]</span>
<span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;90S&#39;</span><span class="p">,</span><span class="s1">&#39;75S&#39;</span><span class="p">,</span><span class="s1">&#39;60S&#39;</span><span class="p">,</span><span class="s1">&#39;45S&#39;</span><span class="p">,</span><span class="s1">&#39;30S&#39;</span><span class="p">,</span><span class="s1">&#39;15S&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;15N&#39;</span><span class="p">,</span>
             <span class="s1">&#39;30N&#39;</span><span class="p">,</span><span class="s1">&#39;45N&#39;</span><span class="p">,</span><span class="s1">&#39;60N&#39;</span><span class="p">,</span><span class="s1">&#39;75N&#39;</span><span class="p">,</span><span class="s1">&#39;90N&#39;</span><span class="p">]</span>
<span class="n">xpts</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">]</span>
<span class="n">ypts</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">]</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gset</span><span class="p">(</span><span class="n">xmin</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">()</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Zonal mean zonal wind&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;100mb&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;200mb&#39;</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticklabels</span><span class="p">,</span>
             <span class="n">legend_location</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">plotvars</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpts</span><span class="p">,</span><span class="n">ypts</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">plotvars</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Region of interest&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig28.png"><img alt="_images/fig28.png" src="_images/fig28.png" style="width: 524.16px; height: 399.88px;" /></a>
</section>
<section id="setting-contour-levels">
<h3>Setting Contour Levels<a class="headerlink" href="#setting-contour-levels" title="Link to this heading">¶</a></h3>
<p>cf-plot generally does a reasonable job of setting appropriate contour levels.  In the cases where it doesn't do this or you need a consistent set of levels between plots for comparison purposes use the levs routine.
The <strong>cfp.levs</strong> command manually sets the contour levels.</p>
<div class="line-block">
<div class="line"><strong>min=min</strong> - minimum level</div>
<div class="line"><strong>max=max</strong> - maximum level</div>
<div class="line"><strong>step=step</strong> - step between levels</div>
<div class="line"><strong>manual= manual</strong> - set levels manually</div>
<div class="line"><strong>extend='neither', 'both', 'min', or 'max'</strong> – the colour bar limit extensions. These are the triangles at the ends of the colour bar indicating the rest of the data is in this colour.</div>
</div>
<p>Use the <strong>cfp.levs</strong> command when a predefined set of levels is required. The <strong>min, max and step</strong> parameters are all needed to define a set of levels. These can take integer or floating point numbers. If colour filled contours are plotted then the default is to extend the minimum and maximum contours coloured for out of range values - extend='both'. Use the manual option to define a set of uneven contours i.e.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="n">manual</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
<p>Once a user call is made to levs the levels are persistent. i.e. the next plot will use the same set of levels. Use <strong>cfp.levs()</strong> to reset to undefined levels i.e. let cf-plot generate the levels again.
Once the <strong>cfp.levs</strong> command is used you'll need to think about the associated colour scale.</p>
</section>
<section id="colour-scales">
<span id="colour"></span><h3>Colour scales<a class="headerlink" href="#colour-scales" title="Link to this heading">¶</a></h3>
<p>There are around 140 colour scales included with cf-plot. Colour scales are set with the cscale command. There are two default colour scales that suit differing types of data.</p>
<p>A continuous scale <strong>cfp.scale('viridis')</strong> that goes from blue to green and then yellow and suits data that has no zero in it.  For example air temperature in Kelvin or geopotential height - see example 1 in the gallery plots.</p>
<p>A diverging scale <strong>cfp.cscale('scale1')</strong> that goes from blue to red and suits data with a zero in it.  For example temperature in Celsius or zonal wind - see example 4 in the gallery plots.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">80</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;scale1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/cs1.png"><img alt="_images/cs1.png" src="_images/cs1.png" style="width: 502.32px; height: 26.0px;" /></a>
<p>If no call has been made to adjust the colour scale then continuous and diverging colour scales are self adjusting to fit the number of levels automatically generated by cf-plot or specified by the user with the <strong>cfp.levs</strong> command.  This behaviour is also followed for a simple call to <strong>cfp.cscale</strong> specifying a different colour scale - for example <strong>cfp.cscale('radar')</strong> to select the radar colour scheme.</p>
<p>If a call to <strong>cfp.cscale</strong> specifies additional parameters to the colour scale, then the automatic colour adjustment is turned off giving the user fine tuning of colours as below.</p>
<p>To change the number of colours in a scale use the ncols parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;scale1&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/cs2.png"><img alt="_images/cs2.png" src="_images/cs2.png" style="width: 502.32px; height: 26.0px;" /></a>
<p>To change the number of colours above and below the mid-point of the scale use the above and below parameters. This is useful for fields where you have differing extents of data above and below the zero line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;scale1&#39;</span><span class="p">,</span> <span class="n">below</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">above</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/cs3.png"><img alt="_images/cs3.png" src="_images/cs3.png" style="width: 502.32px; height: 26.0px;" /></a>
<p>For data where you need white to indicate that this data region is insignificant use the white=white parameter. This can take single or multiple values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;scale1&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">white</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="n">manual</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/cs4.png"><img alt="_images/cs4.png" src="_images/cs4.png" style="width: 502.32px; height: 26.0px;" /></a>
<p>To reverse a colour scale use the <strong>reverse=True</strong> option to <strong>cfp.cscale</strong> and specify the number of colours required.</p>
<p><strong>cfp.cscale('viridis', reverse=True, ncols=17)</strong></p>
</section>
<section id="producing-a-uniform-colour-scale">
<h3>Producing a uniform colour scale<a class="headerlink" href="#producing-a-uniform-colour-scale" title="Link to this heading">¶</a></h3>
<p>The uniform parameter may be of use when using a set of contour levels where there is wide mismatch between the
above and below numbers.</p>
<p><strong>uniform = False</strong> - produce a uniform colour scale.
For example: if <strong>below=3</strong> and <strong>above=10</strong> are specified then initially <strong>below=10</strong> and <strong>above=10</strong> are used. The
colour scale is then cropped to use scale colours 6 to 19.  This produces a more uniform intensity colour
scale than one where all the blues are compressed into 3 colours.</p>
</section>
<section id="user-defined-colour-scales">
<h3>User defined colour scales<a class="headerlink" href="#user-defined-colour-scales" title="Link to this heading">¶</a></h3>
<p>Colour scales are stored as red green blue values on a scale of 0 to 255. Put these in a file with one red green blue value per line. i.e.</p>
<div class="line-block">
<div class="line">255 0   0</div>
<div class="line">255 255 255</div>
<div class="line">0   0   255</div>
</div>
<p>will give a red white blue colour scale. If the file is saved as /home/swsheaps/rwb.txt it is read in using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;/home/swsheaps/rwb.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the colour scale selected has too few colours for the number of contour levels then the colours will be used cyclically.</p>
</section>
<section id="changing-colours-in-a-colour-scale">
<h3>Changing colours in a colour scale<a class="headerlink" href="#changing-colours-in-a-colour-scale" title="Link to this heading">¶</a></h3>
<p>The simplest way to do this without writing any code is to modify the internal colour scale before plotting.  The colours most people work with are stored as red green blue intensities on a scale of 0 to 255, with 0 being no intensity and 255 full intensity.</p>
<p>White is represented as 255 255 255 and black as 0 0 0</p>
<p>The internal colour scale is stored in cfp.plotvars.cs as hexadecimal code.  To convert from decimal to hexadecimal use the Python hex function i.e.</p>
<div class="line-block">
<div class="line"><strong>hex(255)[2:]</strong></div>
<div class="line">'ff'</div>
</div>
<p>The [2:] is to get rid of the preceding 0x in the hex output.</p>
<p>For example to make one of the colours in the viridis colour scale grey use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cscale</span><span class="p">(</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">plotvars</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;#a6a6a6&#39;</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="predefined-colour-scales">
<h3>Predefined colour scales<a class="headerlink" href="#predefined-colour-scales" title="Link to this heading">¶</a></h3>
<p>A lot of the following colour maps were downloaded from the NCAR Command Language web site. Users of the IDL guide colour maps can see these maps at the end of the colour scales.</p>
</section>
<section id="perceptually-uniform-colour-scales">
<h3>Perceptually uniform colour scales<a class="headerlink" href="#perceptually-uniform-colour-scales" title="Link to this heading">¶</a></h3>
<p>A selection of perceptually uniform colour scales for contouring data without a zero in. See <a class="reference external" href="http://www.climate-lab-book.ac.uk/2014/end-of-the-rainbow">The end of the rainbow</a> and <a class="reference external" href="http://bids.github.io/colormap">Matplotlib colour maps</a> for a good discussion on colour scales, colour blindness and uniform colour scales.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Scale</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>viridis</p></td>
<td><img alt="_images/viridis.png" src="_images/viridis.png" />
</td>
</tr>
<tr class="row-odd"><td><p>magma</p></td>
<td><img alt="_images/magma.png" src="_images/magma.png" />
</td>
</tr>
<tr class="row-even"><td><p>inferno</p></td>
<td><img alt="_images/inferno.png" src="_images/inferno.png" />
</td>
</tr>
<tr class="row-odd"><td><p>plasma</p></td>
<td><img alt="_images/plasma.png" src="_images/plasma.png" />
</td>
</tr>
<tr class="row-even"><td><p>parula</p></td>
<td><img alt="_images/parula.png" src="_images/parula.png" />
</td>
</tr>
<tr class="row-odd"><td><p>gray</p></td>
<td><img alt="_images/gray.png" src="_images/gray.png" />
</td>
</tr>
</tbody>
</table>
</section>
<section id="ncar-command-language-meteoswiss-colour-maps">
<h3>NCAR Command Language - MeteoSwiss colour maps<a class="headerlink" href="#ncar-command-language-meteoswiss-colour-maps" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Scale</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>hotcold_18lev</p></td>
<td><img alt="_images/hotcold_18lev.png" src="_images/hotcold_18lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>hotcolr_19lev</p></td>
<td><img alt="_images/hotcolr_19lev.png" src="_images/hotcolr_19lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>mch_default</p></td>
<td><img alt="_images/mch_default.png" src="_images/mch_default.png" />
</td>
</tr>
<tr class="row-odd"><td><p>perc2_9lev</p></td>
<td><img alt="_images/perc2_9lev.png" src="_images/perc2_9lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>percent_11lev</p></td>
<td><img alt="_images/percent_11lev.png" src="_images/percent_11lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>precip2_15lev</p></td>
<td><img alt="_images/precip2_15lev.png" src="_images/precip2_15lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>precip2_17lev</p></td>
<td><img alt="_images/precip2_17lev.png" src="_images/precip2_17lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>precip3_16lev</p></td>
<td><img alt="_images/precip3_16lev.png" src="_images/precip3_16lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>precip4_11lev</p></td>
<td><img alt="_images/precip4_11lev.png" src="_images/precip4_11lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>precip4_diff_19lev</p></td>
<td><img alt="_images/precip4_diff_19lev.png" src="_images/precip4_diff_19lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>precip_11lev</p></td>
<td><img alt="_images/precip_11lev.png" src="_images/precip_11lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>precip_diff_12lev</p></td>
<td><img alt="_images/precip_diff_12lev.png" src="_images/precip_diff_12lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>precip_diff_1lev</p></td>
<td><img alt="_images/precip_diff_1lev.png" src="_images/precip_diff_1lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>rh_19lev</p></td>
<td><img alt="_images/rh_19lev.png" src="_images/rh_19lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>spread_15lev</p></td>
<td><img alt="_images/spread_15lev.png" src="_images/spread_15lev.png" />
</td>
</tr>
</tbody>
</table>
</section>
<section id="ncar-command-language-small-color-maps-50-colours">
<h3>NCAR Command Language - small color maps (&lt;50 colours)<a class="headerlink" href="#ncar-command-language-small-color-maps-50-colours" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Scale</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>amwg</p></td>
<td><img alt="_images/amwg.png" src="_images/amwg.png" />
</td>
</tr>
<tr class="row-odd"><td><p>amwg_blueyellowred</p></td>
<td><img alt="_images/amwg_blueyellowred.png" src="_images/amwg_blueyellowred.png" />
</td>
</tr>
<tr class="row-even"><td><p>BlueDarkRed18</p></td>
<td><img alt="_images/BlueDarkRed18.png" src="_images/BlueDarkRed18.png" />
</td>
</tr>
<tr class="row-odd"><td><p>BlueDarkOrange18</p></td>
<td><img alt="_images/BlueDarkOrange18.png" src="_images/BlueDarkOrange18.png" />
</td>
</tr>
<tr class="row-even"><td><p>BlueGreen14</p></td>
<td><img alt="_images/BlueGreen14.png" src="_images/BlueGreen14.png" />
</td>
</tr>
<tr class="row-odd"><td><p>BrownBlue12</p></td>
<td><img alt="_images/BrownBlue12.png" src="_images/BrownBlue12.png" />
</td>
</tr>
<tr class="row-even"><td><p>Cat12</p></td>
<td><img alt="_images/Cat12.png" src="_images/Cat12.png" />
</td>
</tr>
<tr class="row-odd"><td><p>cmp_flux</p></td>
<td><img alt="_images/cmp_flux.png" src="_images/cmp_flux.png" />
</td>
</tr>
<tr class="row-even"><td><p>cosam12</p></td>
<td><img alt="_images/cosam12.png" src="_images/cosam12.png" />
</td>
</tr>
<tr class="row-odd"><td><p>cosam</p></td>
<td><img alt="_images/cosam.png" src="_images/cosam.png" />
</td>
</tr>
<tr class="row-even"><td><p>GHRSST_anomaly</p></td>
<td><img alt="_images/GHRSST_anomaly.png" src="_images/GHRSST_anomaly.png" />
</td>
</tr>
<tr class="row-odd"><td><p>GreenMagenta16</p></td>
<td><img alt="_images/GreenMagenta16.png" src="_images/GreenMagenta16.png" />
</td>
</tr>
<tr class="row-even"><td><p>hotcold_18lev</p></td>
<td><img alt="_images/hotcold_18lev.png" src="_images/hotcold_18lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>hotcolr_19lev</p></td>
<td><img alt="_images/hotcolr_19lev.png" src="_images/hotcolr_19lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>mch_default</p></td>
<td><img alt="_images/mch_default.png" src="_images/mch_default.png" />
</td>
</tr>
<tr class="row-odd"><td><p>nrl_sirkes</p></td>
<td><img alt="_images/nrl_sirkes.png" src="_images/nrl_sirkes.png" />
</td>
</tr>
<tr class="row-even"><td><p>nrl_sirkes_nowhite</p></td>
<td><img alt="_images/nrl_sirkes_nowhite.png" src="_images/nrl_sirkes_nowhite.png" />
</td>
</tr>
<tr class="row-odd"><td><p>perc2_9lev</p></td>
<td><img alt="_images/perc2_9lev.png" src="_images/perc2_9lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>percent_11lev</p></td>
<td><img alt="_images/percent_11lev.png" src="_images/percent_11lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>posneg_2</p></td>
<td><img alt="_images/posneg_2.png" src="_images/posneg_2.png" />
</td>
</tr>
<tr class="row-even"><td><p>prcp_1</p></td>
<td><img alt="_images/prcp_1.png" src="_images/prcp_1.png" />
</td>
</tr>
<tr class="row-odd"><td><p>prcp_2</p></td>
<td><img alt="_images/prcp_2.png" src="_images/prcp_2.png" />
</td>
</tr>
<tr class="row-even"><td><p>prcp_3</p></td>
<td><img alt="_images/prcp_3.png" src="_images/prcp_3.png" />
</td>
</tr>
<tr class="row-odd"><td><p>precip_11lev</p></td>
<td><img alt="_images/precip_11lev.png" src="_images/precip_11lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>precip_diff_12lev</p></td>
<td><img alt="_images/precip_diff_12lev.png" src="_images/precip_diff_12lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>precip_diff_1lev</p></td>
<td><img alt="_images/precip_diff_1lev.png" src="_images/precip_diff_1lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>precip2_15lev</p></td>
<td><img alt="_images/precip2_15lev.png" src="_images/precip2_15lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>precip2_17lev</p></td>
<td><img alt="_images/precip2_17lev.png" src="_images/precip2_17lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>precip3_16lev</p></td>
<td><img alt="_images/precip3_16lev.png" src="_images/precip3_16lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>precip4_11lev</p></td>
<td><img alt="_images/precip4_11lev.png" src="_images/precip4_11lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>precip4_diff_19lev</p></td>
<td><img alt="_images/precip4_diff_19lev.png" src="_images/precip4_diff_19lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>radar</p></td>
<td><img alt="_images/radar.png" src="_images/radar.png" />
</td>
</tr>
<tr class="row-even"><td><p>radar_1</p></td>
<td><img alt="_images/radar_1.png" src="_images/radar_1.png" />
</td>
</tr>
<tr class="row-odd"><td><p>rh_19lev</p></td>
<td><img alt="_images/rh_19lev.png" src="_images/rh_19lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>seaice_1</p></td>
<td><img alt="_images/seaice_1.png" src="_images/seaice_1.png" />
</td>
</tr>
<tr class="row-odd"><td><p>seaice_2</p></td>
<td><img alt="_images/seaice_2.png" src="_images/seaice_2.png" />
</td>
</tr>
<tr class="row-even"><td><p>so4_21</p></td>
<td><img alt="_images/so4_21.png" src="_images/so4_21.png" />
</td>
</tr>
<tr class="row-odd"><td><p>spread_15lev</p></td>
<td><img alt="_images/spread_15lev.png" src="_images/spread_15lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>StepSeq25</p></td>
<td><img alt="_images/StepSeq25.png" src="_images/StepSeq25.png" />
</td>
</tr>
<tr class="row-odd"><td><p>sunshine_9lev</p></td>
<td><img alt="_images/sunshine_9lev.png" src="_images/sunshine_9lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>sunshine_diff_12lev</p></td>
<td><img alt="_images/sunshine_diff_12lev.png" src="_images/sunshine_diff_12lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>temp_19lev</p></td>
<td><img alt="_images/temp_19lev.png" src="_images/temp_19lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>temp_diff_18lev</p></td>
<td><img alt="_images/temp_diff_18lev.png" src="_images/temp_diff_18lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>temp_diff_1lev</p></td>
<td><img alt="_images/temp_diff_1lev.png" src="_images/temp_diff_1lev.png" />
</td>
</tr>
<tr class="row-even"><td><p>topo_15lev</p></td>
<td><img alt="_images/topo_15lev.png" src="_images/topo_15lev.png" />
</td>
</tr>
<tr class="row-odd"><td><p>wgne15</p></td>
<td><img alt="_images/wgne15.png" src="_images/wgne15.png" />
</td>
</tr>
<tr class="row-even"><td><p>wind_17lev</p></td>
<td><img alt="_images/wind_17lev.png" src="_images/wind_17lev.png" />
</td>
</tr>
</tbody>
</table>
</section>
<section id="ncar-command-language-large-colour-maps-50-colours">
<h3>NCAR Command Language - large colour maps (&gt;50 colours)<a class="headerlink" href="#ncar-command-language-large-colour-maps-50-colours" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Scale</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>amwg256</p></td>
<td><img alt="_images/amwg256.png" src="_images/amwg256.png" />
</td>
</tr>
<tr class="row-odd"><td><p>BkBlAqGrYeOrReViWh200</p></td>
<td><img alt="_images/BkBlAqGrYeOrReViWh200.png" src="_images/BkBlAqGrYeOrReViWh200.png" />
</td>
</tr>
<tr class="row-even"><td><p>BlAqGrYeOrRe</p></td>
<td><img alt="_images/BlAqGrYeOrRe.png" src="_images/BlAqGrYeOrRe.png" />
</td>
</tr>
<tr class="row-odd"><td><p>BlAqGrYeOrReVi200</p></td>
<td><img alt="_images/BlAqGrYeOrReVi200.png" src="_images/BlAqGrYeOrReVi200.png" />
</td>
</tr>
<tr class="row-even"><td><p>BlGrYeOrReVi200</p></td>
<td><img alt="_images/BlGrYeOrReVi200.png" src="_images/BlGrYeOrReVi200.png" />
</td>
</tr>
<tr class="row-odd"><td><p>BlRe</p></td>
<td><img alt="_images/BlRe.png" src="_images/BlRe.png" />
</td>
</tr>
<tr class="row-even"><td><p>BlueRed</p></td>
<td><img alt="_images/BlueRed.png" src="_images/BlueRed.png" />
</td>
</tr>
<tr class="row-odd"><td><p>BlueRedGray</p></td>
<td><img alt="_images/BlueRedGray.png" src="_images/BlueRedGray.png" />
</td>
</tr>
<tr class="row-even"><td><p>BlueWhiteOrangeRed</p></td>
<td><img alt="_images/BlueWhiteOrangeRed.png" src="_images/BlueWhiteOrangeRed.png" />
</td>
</tr>
<tr class="row-odd"><td><p>BlueYellowRed</p></td>
<td><img alt="_images/BlueYellowRed.png" src="_images/BlueYellowRed.png" />
</td>
</tr>
<tr class="row-even"><td><p>BlWhRe</p></td>
<td><img alt="_images/BlWhRe.png" src="_images/BlWhRe.png" />
</td>
</tr>
<tr class="row-odd"><td><p>cmp_b2r</p></td>
<td><img alt="_images/cmp_b2r.png" src="_images/cmp_b2r.png" />
</td>
</tr>
<tr class="row-even"><td><p>cmp_haxby</p></td>
<td><img alt="_images/cmp_haxby.png" src="_images/cmp_haxby.png" />
</td>
</tr>
<tr class="row-odd"><td><p>detail</p></td>
<td><img alt="_images/detail.png" src="_images/detail.png" />
</td>
</tr>
<tr class="row-even"><td><p>extrema</p></td>
<td><img alt="_images/extrema.png" src="_images/extrema.png" />
</td>
</tr>
<tr class="row-odd"><td><p>GrayWhiteGray</p></td>
<td><img alt="_images/GrayWhiteGray.png" src="_images/GrayWhiteGray.png" />
</td>
</tr>
<tr class="row-even"><td><p>GreenYellow</p></td>
<td><img alt="_images/GreenYellow.png" src="_images/GreenYellow.png" />
</td>
</tr>
<tr class="row-odd"><td><p>helix</p></td>
<td><img alt="_images/helix.png" src="_images/helix.png" />
</td>
</tr>
<tr class="row-even"><td><p>helix1</p></td>
<td><img alt="_images/helix1.png" src="_images/helix1.png" />
</td>
</tr>
<tr class="row-odd"><td><p>hotres</p></td>
<td><img alt="_images/hotres.png" src="_images/hotres.png" />
</td>
</tr>
<tr class="row-even"><td><p>matlab_hot</p></td>
<td><img alt="_images/matlab_hot.png" src="_images/matlab_hot.png" />
</td>
</tr>
<tr class="row-odd"><td><p>matlab_hsv</p></td>
<td><img alt="_images/matlab_hsv.png" src="_images/matlab_hsv.png" />
</td>
</tr>
<tr class="row-even"><td><p>matlab_jet</p></td>
<td><img alt="_images/matlab_jet.png" src="_images/matlab_jet.png" />
</td>
</tr>
<tr class="row-odd"><td><p>matlab_lines</p></td>
<td><img alt="_images/matlab_lines.png" src="_images/matlab_lines.png" />
</td>
</tr>
<tr class="row-even"><td><p>ncl_default</p></td>
<td><img alt="_images/ncl_default.png" src="_images/ncl_default.png" />
</td>
</tr>
<tr class="row-odd"><td><p>ncview_default</p></td>
<td><img alt="_images/ncview_default.png" src="_images/ncview_default.png" />
</td>
</tr>
<tr class="row-even"><td><p>OceanLakeLandSnow</p></td>
<td><img alt="_images/OceanLakeLandSnow.png" src="_images/OceanLakeLandSnow.png" />
</td>
</tr>
<tr class="row-odd"><td><p>rainbow</p></td>
<td><img alt="_images/rainbow.png" src="_images/rainbow.png" />
</td>
</tr>
<tr class="row-even"><td><p>rainbow_white_gray</p></td>
<td><img alt="_images/rainbow_white_gray.png" src="_images/rainbow_white_gray.png" />
</td>
</tr>
<tr class="row-odd"><td><p>rainbow_white</p></td>
<td><img alt="_images/rainbow_white.png" src="_images/rainbow_white.png" />
</td>
</tr>
<tr class="row-even"><td><p>rainbow_gray</p></td>
<td><img alt="_images/rainbow_gray.png" src="_images/rainbow_gray.png" />
</td>
</tr>
<tr class="row-odd"><td><p>tbr_240_300</p></td>
<td><img alt="_images/tbr_240_300.png" src="_images/tbr_240_300.png" />
</td>
</tr>
<tr class="row-even"><td><p>tbr_stdev_0_30</p></td>
<td><img alt="_images/tbr_stdev_0_30.png" src="_images/tbr_stdev_0_30.png" />
</td>
</tr>
<tr class="row-odd"><td><p>tbr_var_0_500</p></td>
<td><img alt="_images/tbr_var_0_500.png" src="_images/tbr_var_0_500.png" />
</td>
</tr>
<tr class="row-even"><td><p>tbrAvg1</p></td>
<td><img alt="_images/tbrAvg1.png" src="_images/tbrAvg1.png" />
</td>
</tr>
<tr class="row-odd"><td><p>tbrStd1</p></td>
<td><img alt="_images/tbrStd1.png" src="_images/tbrStd1.png" />
</td>
</tr>
<tr class="row-even"><td><p>tbrVar1</p></td>
<td><img alt="_images/tbrVar1.png" src="_images/tbrVar1.png" />
</td>
</tr>
<tr class="row-odd"><td><p>thelix</p></td>
<td><img alt="_images/thelix.png" src="_images/thelix.png" />
</td>
</tr>
<tr class="row-even"><td><p>ViBlGrWhYeOrRe</p></td>
<td><img alt="_images/ViBlGrWhYeOrRe.png" src="_images/ViBlGrWhYeOrRe.png" />
</td>
</tr>
<tr class="row-odd"><td><p>wh_bl_gr_ye_re</p></td>
<td><img alt="_images/wh_bl_gr_ye_re.png" src="_images/wh_bl_gr_ye_re.png" />
</td>
</tr>
<tr class="row-even"><td><p>WhBlGrYeRe</p></td>
<td><img alt="_images/WhBlGrYeRe.png" src="_images/WhBlGrYeRe.png" />
</td>
</tr>
<tr class="row-odd"><td><p>WhBlReWh</p></td>
<td><img alt="_images/WhBlReWh.png" src="_images/WhBlReWh.png" />
</td>
</tr>
<tr class="row-even"><td><p>WhiteBlue</p></td>
<td><img alt="_images/WhiteBlue.png" src="_images/WhiteBlue.png" />
</td>
</tr>
<tr class="row-odd"><td><p>WhiteBlueGreenYellowRed</p></td>
<td><img alt="_images/WhiteBlueGreenYellowRed.png" src="_images/WhiteBlueGreenYellowRed.png" />
</td>
</tr>
<tr class="row-even"><td><p>WhiteGreen</p></td>
<td><img alt="_images/WhiteGreen.png" src="_images/WhiteGreen.png" />
</td>
</tr>
<tr class="row-odd"><td><p>WhiteYellowOrangeRed</p></td>
<td><img alt="_images/WhiteYellowOrangeRed.png" src="_images/WhiteYellowOrangeRed.png" />
</td>
</tr>
<tr class="row-even"><td><p>WhViBlGrYeOrRe</p></td>
<td><img alt="_images/WhViBlGrYeOrRe.png" src="_images/WhViBlGrYeOrRe.png" />
</td>
</tr>
<tr class="row-odd"><td><p>WhViBlGrYeOrReWh</p></td>
<td><img alt="_images/WhViBlGrYeOrReWh.png" src="_images/WhViBlGrYeOrReWh.png" />
</td>
</tr>
<tr class="row-even"><td><p>wxpEnIR</p></td>
<td><img alt="_images/wxpEnIR.png" src="_images/wxpEnIR.png" />
</td>
</tr>
<tr class="row-odd"><td><p>3gauss</p></td>
<td><img alt="_images/3gauss.png" src="_images/3gauss.png" />
</td>
</tr>
<tr class="row-even"><td><p>3saw</p></td>
<td><img alt="_images/3saw.png" src="_images/3saw.png" />
</td>
</tr>
<tr class="row-odd"><td><p>BrBG</p></td>
<td><img alt="_images/BrBG.png" src="_images/BrBG.png" />
</td>
</tr>
</tbody>
</table>
</section>
<section id="ncar-command-language-enhanced-to-help-with-colour-blindness">
<h3>NCAR Command Language - Enhanced to help with colour blindness<a class="headerlink" href="#ncar-command-language-enhanced-to-help-with-colour-blindness" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Scale</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>StepSeq25</p></td>
<td><img alt="_images/StepSeq25.png" src="_images/StepSeq25.png" />
</td>
</tr>
<tr class="row-odd"><td><p>posneg_2</p></td>
<td><img alt="_images/posneg_2.png" src="_images/posneg_2.png" />
</td>
</tr>
<tr class="row-even"><td><p>posneg_1</p></td>
<td><img alt="_images/posneg_1.png" src="_images/posneg_1.png" />
</td>
</tr>
<tr class="row-odd"><td><p>BlueDarkOrange18</p></td>
<td><img alt="_images/BlueDarkOrange18.png" src="_images/BlueDarkOrange18.png" />
</td>
</tr>
<tr class="row-even"><td><p>BlueDarkRed18</p></td>
<td><img alt="_images/BlueDarkRed18.png" src="_images/BlueDarkRed18.png" />
</td>
</tr>
<tr class="row-odd"><td><p>GreenMagenta16</p></td>
<td><img alt="_images/GreenMagenta16.png" src="_images/GreenMagenta16.png" />
</td>
</tr>
<tr class="row-even"><td><p>BlueGreen14</p></td>
<td><img alt="_images/BlueGreen14.png" src="_images/BlueGreen14.png" />
</td>
</tr>
<tr class="row-odd"><td><p>BrownBlue12</p></td>
<td><img alt="_images/BrownBlue12.png" src="_images/BrownBlue12.png" />
</td>
</tr>
<tr class="row-even"><td><p>Cat12</p></td>
<td><img alt="_images/Cat12.png" src="_images/Cat12.png" />
</td>
</tr>
</tbody>
</table>
</section>
<section id="idl-guide-scales">
<h3>IDL guide scales<a class="headerlink" href="#idl-guide-scales" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Scale</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>scale1</p></td>
<td><img alt="_images/scale1.png" src="_images/scale1.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale2</p></td>
<td><img alt="_images/scale2.png" src="_images/scale2.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale3</p></td>
<td><img alt="_images/scale3.png" src="_images/scale3.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale4</p></td>
<td><img alt="_images/scale4.png" src="_images/scale4.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale5</p></td>
<td><img alt="_images/scale5.png" src="_images/scale5.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale6</p></td>
<td><img alt="_images/scale6.png" src="_images/scale6.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale7</p></td>
<td><img alt="_images/scale7.png" src="_images/scale7.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale8</p></td>
<td><img alt="_images/scale8.png" src="_images/scale8.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale9</p></td>
<td><img alt="_images/scale9.png" src="_images/scale9.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale10</p></td>
<td><img alt="_images/scale10.png" src="_images/scale10.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale11</p></td>
<td><img alt="_images/scale11.png" src="_images/scale11.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale12</p></td>
<td><img alt="_images/scale12.png" src="_images/scale12.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale13</p></td>
<td><img alt="_images/scale13.png" src="_images/scale13.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale14</p></td>
<td><img alt="_images/scale14.png" src="_images/scale14.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale15</p></td>
<td><img alt="_images/scale15.png" src="_images/scale15.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale16</p></td>
<td><img alt="_images/scale16.png" src="_images/scale16.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale17</p></td>
<td><img alt="_images/scale17.png" src="_images/scale17.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale18</p></td>
<td><img alt="_images/scale18.png" src="_images/scale18.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale19</p></td>
<td><img alt="_images/scale19.png" src="_images/scale19.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale20</p></td>
<td><img alt="_images/scale20.png" src="_images/scale20.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale21</p></td>
<td><img alt="_images/scale21.png" src="_images/scale21.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale22</p></td>
<td><img alt="_images/scale22.png" src="_images/scale22.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale23</p></td>
<td><img alt="_images/scale23.png" src="_images/scale23.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale24</p></td>
<td><img alt="_images/scale24.png" src="_images/scale24.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale25</p></td>
<td><img alt="_images/scale25.png" src="_images/scale25.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale26</p></td>
<td><img alt="_images/scale26.png" src="_images/scale26.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale27</p></td>
<td><img alt="_images/scale27.png" src="_images/scale27.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale28</p></td>
<td><img alt="_images/scale28.png" src="_images/scale28.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale29</p></td>
<td><img alt="_images/scale29.png" src="_images/scale29.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale30</p></td>
<td><img alt="_images/scale30.png" src="_images/scale30.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale31</p></td>
<td><img alt="_images/scale31.png" src="_images/scale31.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale32</p></td>
<td><img alt="_images/scale32.png" src="_images/scale32.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale33</p></td>
<td><img alt="_images/scale33.png" src="_images/scale33.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale34</p></td>
<td><img alt="_images/scale34.png" src="_images/scale34.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale35</p></td>
<td><img alt="_images/scale35.png" src="_images/scale35.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale36</p></td>
<td><img alt="_images/scale36.png" src="_images/scale36.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale37</p></td>
<td><img alt="_images/scale37.png" src="_images/scale37.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale38</p></td>
<td><img alt="_images/scale38.png" src="_images/scale38.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale39</p></td>
<td><img alt="_images/scale39.png" src="_images/scale39.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale40</p></td>
<td><img alt="_images/scale40.png" src="_images/scale40.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale41</p></td>
<td><img alt="_images/scale41.png" src="_images/scale41.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale42</p></td>
<td><img alt="_images/scale42.png" src="_images/scale42.png" />
</td>
</tr>
<tr class="row-even"><td><p>scale43</p></td>
<td><img alt="_images/scale43.png" src="_images/scale43.png" />
</td>
</tr>
<tr class="row-odd"><td><p>scale44</p></td>
<td><img alt="_images/scale44.png" src="_images/scale44.png" />
</td>
</tr>
</tbody>
</table>
</section>
<section id="colour-bars">
<h3>Colour bars<a class="headerlink" href="#colour-bars" title="Link to this heading">¶</a></h3>
<p>Colour bars are often associated with filled colour contour plots and the options for the colour bar are described in the <a class="reference internal" href="cbar.html#cbar"><span class="std std-ref">cbar</span></a> .  If the colour bar options are changed within the call to <strong>cfp.con</strong> then prepend <a href="#id6"><span class="problematic" id="id7">colorbar_</span></a> to the appropriate colour bar option.  cf-plot has used the American spelling for colorbar for compatability with the spelling and usage within the Matplotlib Python package.</p>
<p>Below are some examples of calls to <strong>cfp.cbar</strong></p>
<a class="reference internal image-reference" href="_images/cbar.png"><img alt="_images/cbar.png" src="_images/cbar.png" style="width: 520.52px; height: 288.08px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">()</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">cbar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;text overlapping with default fontsize&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">setvars</span><span class="p">(</span><span class="n">colorbar_fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cbar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;colorbar_fontsize=7&#39;</span><span class="p">)</span>


<span class="c1"># Reset font size</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">setvars</span><span class="p">()</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">cbar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">text_down_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;text_down_up&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">cbar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">text_up_down</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;text_up_down&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">cbar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">text_down_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drawedges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
         <span class="n">title</span><span class="o">=</span><span class="s1">&#39;text_down_up, drawedges=False&#39;</span><span class="p">)</span>



<span class="n">levs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
<span class="n">labels_mid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>


<span class="n">cfp</span><span class="o">.</span><span class="n">cbar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">extend</span> <span class="o">=</span><span class="s1">&#39;neither&#39;</span><span class="p">,</span>
         <span class="n">levs</span><span class="o">=</span><span class="n">levs</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Normal labelling at the division boundary&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">cbar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">extend</span> <span class="o">=</span><span class="s1">&#39;neither&#39;</span><span class="p">,</span> <span class="n">mid</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
         <span class="n">levs</span><span class="o">=</span><span class="n">levs</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_mid</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mid=True and three colorbar labels&#39;</span><span class="p">)</span>


<span class="c1">#Turn off plot axes</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">plotvars</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="labelling-time-axes">
<h3>Labelling time axes<a class="headerlink" href="#labelling-time-axes" title="Link to this heading">¶</a></h3>
<p>The default time axis labelling in cf-plot might not be what is required and here is some information on
using cf-python to extract values for yourself.</p>
<div class="line-block">
<div class="line"><strong>f=cf.read('cfplot_data/tas_A1.nc')[0]</strong></div>
<div class="line"><strong>f.construct('T')</strong></div>
<div class="line">&lt;CF DimensionCoordinate: time(1680) days since 1860-1-1 360_day&gt;</div>
</div>
<p>The time strings are stored in <strong>dtarray</strong> and the time values in <strong>array</strong>:</p>
<div class="line-block">
<div class="line"><strong>f.construct('T').dtarray</strong></div>
<div class="line-block">
<div class="line">array([&lt;CF Datetime: 1860-01-16T00:00:00Z 360_day&gt;,</div>
<div class="line-block">
<div class="line">&lt;CF Datetime: 1860-02-16T00:00:00Z 360_day&gt;,</div>
<div class="line">&lt;CF Datetime: 1860-03-16T00:00:00Z 360_day&gt;, ...,</div>
<div class="line">&lt;CF Datetime: 1999-10-16T00:00:00Z 360_day&gt;,</div>
<div class="line">&lt;CF Datetime: 1999-11-16T00:00:00Z 360_day&gt;,</div>
<div class="line">&lt;CF Datetime: 1999-12-16T00:00:00Z 360_day&gt;], dtype=object)</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">array([1.5000e+01, 4.5000e+01, 7.5000e+01, ..., 5.0325e+04, 5.0355e+04,
5.0385e+04])</div>
</div>
<div class="line-block">
<div class="line"><strong>f.construct('T').array</strong></div>
<div class="line-block">
<div class="line">array([1.5000e+01, 4.5000e+01, 7.5000e+01, ..., 5.0325e+04, 5.0355e+04,
5.0385e+04])</div>
</div>
</div>
<p>Likewise the years and months are in year.array and month.array:</p>
<div class="line-block">
<div class="line"><strong>f.construct('T').year.array</strong></div>
<div class="line">array([1860, 1860, 1860, ..., 1999, 1999, 1999])</div>
</div>
<div class="line-block">
<div class="line"><strong>f.construct('T').month.array</strong></div>
<div class="line">array([ 1,  2,  3, ..., 10, 11, 12])</div>
</div>
<p>To find the time value for to the tick position for January 1st 1980 00:00hrs:</p>
<div class="line-block">
<div class="line"><strong>np.min(cf.Data(cf.dt('1980-01-01 00:00:00'), units=f.construct('T').Units).array)</strong></div>
<div class="line">43200.0</div>
</div>
<p>With this technique arrays of custom tick label and positions can be constructed and passed to
the cfp.lineplot or to the cfp.con routines.</p>
<p>Note the correct date format is <strong>'YYYY-MM-DD'</strong> or <strong>'YYYY-MM-DD HH:MM:SS'</strong> - anything else will give unexpected results.</p>
<p>In this example we generate labels for the start of the months in 1980.  If the middle of the month was to be labelled then the day
number would be changed to be 15.  Our xtick positions are accumulated using the above method in the xticks array as a numerical position
along the axis.  In this case we manually specify out tick labels using the xticklabels array of strings.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">xticks</span><span class="o">=</span><span class="p">[]</span>
<span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">mon</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]:</span>
    <span class="n">month_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mon</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mon</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">month_str</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mon</span><span class="p">)</span>
    <span class="n">xtick</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="s1">&#39;1980-&#39;</span><span class="o">+</span> <span class="n">month_str</span> <span class="o">+</span> <span class="s1">&#39;-01 00:00:00&#39;</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">Units</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
    <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xtick</span><span class="p">)</span>



<span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gset</span><span class="p">(</span><span class="s1">&#39;1980-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;1981-01-01&#39;</span><span class="p">,</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">302</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticklabels</span><span class="p">,</span>
             <span class="n">yticks</span><span class="o">=</span><span class="p">[</span><span class="mi">299</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">301</span><span class="p">,</span> <span class="mi">302</span><span class="p">],</span>
             <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Air temperature at the equator in 1980&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/time_axis_labelling.png"><img alt="_images/time_axis_labelling.png" src="_images/time_axis_labelling.png" style="width: 441.32px; height: 347.16px;" /></a>
<p>Axis labels can also be placed at an angle which in the case of time axis labels is often a way of displaying more lengthy labels.
<strong>cfp.setvars(xtick_label_rotation=30)</strong> or <strong>cfp.setvars(ytick_label_rotation=30)</strong> are examples of how to rotate axis labels.</p>
</section>
<section id="selecting-data-that-has-a-lot-of-decimal-places-in-the-axis-values">
<h3>Selecting data that has a lot of decimal places in the axis values<a class="headerlink" href="#selecting-data-that-has-a-lot-of-decimal-places-in-the-axis-values" title="Link to this heading">¶</a></h3>
<p>Axes with a lot of decimal places can cause issues with numeric representation and rounding,
In one case</p>
<div class="line-block">
<div class="line"><strong>cfp.lineplot(f.subspace(latitude=50.17530806))</strong></div>
</div>
<p>caused an error as the latitude with 50.17530806 wasn't found.</p>
<p>In cf-python the tolerance for equivalence is</p>
<div class="line-block">
<div class="line"><strong>cf.RTOL()</strong></div>
<div class="line">2.220446049250313e-16</div>
</div>
<p>To set to a lower tolerance use</p>
<div class="line-block">
<div class="line"><strong>g=cf.RTOL(1e-5)</strong></div>
<div class="line"><strong>cf.RTOL()</strong></div>
<div class="line">1e-05</div>
</div>
<p>To swap back use</p>
<div class="line-block">
<div class="line"><strong>cf.RTOL(g)</strong></div>
</div>
<p>After swapping the tolerance to 1e-5 the following finds the latitide as expected.</p>
<div class="line-block">
<div class="line"><strong>cfp.lineplot(f.subspace(latitude=50.17530806))</strong></div>
</div>
<p>We could have worked around this issue with</p>
<div class="line-block">
<div class="line"><strong>cfp.lineplot(f.subspace(latitude=cf.wi(50, 50.2)))</strong></div>
</div>
</section>
<section id="axis-labelling">
<h3>Axis labelling<a class="headerlink" href="#axis-labelling" title="Link to this heading">¶</a></h3>
<p>The priority order of axis labeling in order of preference is:</p>
<div class="line-block">
<div class="line">1) user passed to routine</div>
<div class="line">2) user defined by axes command</div>
<div class="line">3) labels generated internally</div>
</div>
<p>For 1 and 2 the available options are</p>
<div class="line-block">
<div class="line">xticks=None - xtick positions</div>
<div class="line">xticklabels=None - xtick labels</div>
<div class="line">yticks=None - y tick positions</div>
<div class="line">yticklabels=None - ytick labels</div>
<div class="line">xlabel=None - label for x axis</div>
<div class="line">ylabel=None - label for y axis</div>
</div>
<p>When specifying the xticklabels or yticklabels the supplied values must be a string or list of strings and match the number of corresponding tick marks.</p>
</section>
<section id="id5">
<h3>Blockfill plots<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>Blockfill plots used to use the pcolormesh method but this had the advantage of being fast but gave incorrect results with masked data or when the data range wasn't extended in both 'min' and 'max' directions.  The blockfill method now uses PolyCollection from matplotlib.collections to draw the polygons for each colour interval specified by the contour levels.  This also has the advantage that blockfill is now available in other projections such as polar stereographic.  When doing blockfill plots of larger numbers of points the new method is slower so trim down the data to the area being shown before passing to cfp.con to speed it up.</p>
</section>
<section id="making-postscript-or-png-pictures">
<h3>Making postscript or PNG pictures<a class="headerlink" href="#making-postscript-or-png-pictures" title="Link to this heading">¶</a></h3>
<p>There are various methods of producing a figure for use in an external package such as a web document or LaTeX, Word etc.</p>
<div class="line-block">
<div class="line"><strong>cfp.setvars(file='zonal.ps')</strong> write subsequent graphics output directly to a file called zonal.ps</div>
<div class="line"><strong>cfp.setvars(file='zonal.png')</strong> write subsequent graphics output to a file called zonal.png</div>
</div>
<p>To reset to viewing the picture on the screen again use <strong>cfp.setvars()</strong>.</p>
<p>Another method is to use <strong>cfp.gopen()</strong> as when used in making multiple plots.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="s1">&#39;zonal.ps&#39;</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="making-non-blocking-plots">
<h3>Making non-blocking plots<a class="headerlink" href="#making-non-blocking-plots" title="Link to this heading">¶</a></h3>
<p>Using the Python prompt cf-plot will try to use the ImageMagick display command to show the plots.  This is done with subprocess and plots will remain on the screen even if the user exits the Python session.  If the display command isn't installed then cf-plot will use the Matplotlib picture viewer which will block the command prompt until it is quit.  Use <strong>cfp.setvars(viewer='matplotlib')</strong> to set this to be the default for a session even if the display command is available.</p>
<p>On Mac OSX the default is <strong>'matplotlib'</strong> but this can be changed by the user to <strong>'display'</strong> if the ImageMagick display command has been installed.</p>
</section>
<section id="using-cf-plot-in-batch-mode">
<h3>Using cf-plot in batch mode<a class="headerlink" href="#using-cf-plot-in-batch-mode" title="Link to this heading">¶</a></h3>
<p>The following method works in the Reading Meteorology department.
In the file /home/swsheaps/ajh.sh:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">NCAS</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">swsheaps</span><span class="o">/</span><span class="n">ajh</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>In the file /home/users/swsheaps/ajh.py:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">setvars</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/home/swsheaps/ll.png&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
<p>run the batch job today at 16:33:</p>
<p><strong>at -f /home/swsheaps/ajh.sh 16:33</strong></p>
<p>The first two lines of the Python script enable cf-plot to run without requiring an X-server.</p>
</section>
<section id="changing-defaults-via-the-cfplot-defaults-file">
<h3>Changing defaults via the ~/.cfplot_defaults file<a class="headerlink" href="#changing-defaults-via-the-cfplot-defaults-file" title="Link to this heading">¶</a></h3>
<p>A ~/.cfplot_defaults default overide file in the user home directory may contain three
values affecting contour plots initially. Please contact <a class="reference external" href="mailto:andy&#46;heaps&#37;&#52;&#48;ncas&#46;ac&#46;uk">andy<span>&#46;</span>heaps<span>&#64;</span>ncas<span>&#46;</span>ac<span>&#46;</span>uk</a> if you would like any more defaults changed in this manner.</p>
<div class="line-block">
<div class="line">blockfill True</div>
<div class="line">fill False</div>
<div class="line">lines False</div>
</div>
<p>This changes the default cfplot con options from contour fill with contour lines
on top to blockfill with no contour lines on top.  The blockfill, fill and line
options to the con routine override any of these preset values.  The delimter beween the
option and the value must be a space.</p>
</section>
<section id="plotting-data-with-different-time-units">
<h3>Plotting data with different time units<a class="headerlink" href="#plotting-data-with-different-time-units" title="Link to this heading">¶</a></h3>
<p>When plotting data with different time units users need to move their data to using a common set of units as below.</p>
<div class="line-block">
<div class="line"><strong>data1.construct('T').Units</strong></div>
<div class="line">&lt;CF Units: hours since 1900-01-01 00:00:00 standard&gt;</div>
</div>
<div class="line-block">
<div class="line"><strong>data2.construct('T').Units</strong></div>
<div class="line">&lt;CF Units: days since 2008-09-01 00:00:00 standard&gt;</div>
</div>
<div class="line-block">
<div class="line"><strong>data1.construct('T').Units=data2.construct('T').Units</strong></div>
</div>
<div class="line-block">
<div class="line"><strong>data1.construct('T').Units</strong></div>
<div class="line">&lt;CF Units: days since 2008-09-01 00:00:00 standard&gt;</div>
</div>
<p>This is because when making a contour or line plot the axes are defined in terms of a linear scale of numbers.  Having two
different linear scales breaks the connection between the data.</p>
</section>
<section id="blockfill-contour-plots-with-a-time-mean">
<h3>Blockfill contour plots with a time mean<a class="headerlink" href="#blockfill-contour-plots-with-a-time-mean" title="Link to this heading">¶</a></h3>
<p>When plotting a blockfill contour plot of data with a time mean the plot can sometimes produce unexpected results.
For example the following data has monthly data points but bounds of ten years for each point.</p>
<div class="line-block">
<div class="line"><strong>f.coord('T').dtarray</strong></div>
<div class="line">array([cftime.Datetime360Day(1983-08-16 00:00:00),</div>
<div class="line-block">
<div class="line">cftime.Datetime360Day(1983-09-16 00:00:00),</div>
<div class="line">cftime.Datetime360Day(1983-10-16 00:00:00)], dtype=object)</div>
</div>
</div>
<div class="line-block">
<div class="line"><strong>f.coord('T').bounds.dtarray</strong></div>
<div class="line">array([[cftime.Datetime360Day(1979-02-01 00:00:00),</div>
<div class="line-block">
<div class="line-block">
<div class="line">cftime.Datetime360Day(1988-03-01 00:00:00)],</div>
</div>
<div class="line">[cftime.Datetime360Day(1979-03-01 00:00:00),</div>
<div class="line-block">
<div class="line">cftime.Datetime360Day(1988-04-01 00:00:00)],</div>
</div>
<div class="line">[cftime.Datetime360Day(1979-04-01 00:00:00),</div>
<div class="line-block">
<div class="line">cftime.Datetime360Day(1988-05-01 00:00:00)]], dtype=object)</div>
</div>
</div>
</div>
<p>To reset the bounds for this data to be relevant for plotting use</p>
<div class="line-block">
<div class="line"><strong>T=f.coord('T')</strong></div>
<div class="line"><strong>T.del_bounds()</strong></div>
<div class="line"><strong>new_bounds=T.create_bounds()</strong></div>
<div class="line"><strong>T.set_bounds(new_bounds)</strong></div>
</div>
<p>The new time data bounds are now:</p>
<div class="line-block">
<div class="line"><strong>f.coord('T').bounds.dtarray</strong></div>
<div class="line">array([[cftime.Datetime360Day(1983-08-01 00:00:00),</div>
<div class="line-block">
<div class="line-block">
<div class="line">cftime.Datetime360Day(1983-09-01 00:00:00)],</div>
</div>
<div class="line">[cftime.Datetime360Day(1983-09-01 00:00:00),</div>
<div class="line-block">
<div class="line">cftime.Datetime360Day(1983-10-01 00:00:00)],</div>
</div>
<div class="line">[cftime.Datetime360Day(1983-10-01 00:00:00),</div>
<div class="line-block">
<div class="line">cftime.Datetime360Day(1983-11-01 00:00:00)]], dtype=object)</div>
</div>
</div>
</div>
</section>
</section>
<section id="appendix-a-introduction-to-cf-python">
<span id="appendixa"></span><h2>Appendix A - Introduction to cf-python<a class="headerlink" href="#appendix-a-introduction-to-cf-python" title="Link to this heading">¶</a></h2>
<p>cf-python is very flexible and can be used to select fields, levels, times, means for both CF and non-CF compliant data.  CF data is data that follows the NetCDF Climate and Forecast (CF) Metadata Conventions.  The conventions define metadata that provide a definitive description of what the data in each variable represents, and of the spatial and temporal properties of the data.</p>
<section id="reading-in-data-and-field-selection">
<h3>Reading in data and field selection<a class="headerlink" href="#reading-in-data-and-field-selection" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line"><strong>import cf</strong></div>
<div class="line"><strong>fl = cf.read('cfplot_data/ggap.nc')</strong></div>
</div>
<p>f is now an list of 4 fields.  The list is indicated by the square brackets surrounding the fields.</p>
<div class="line-block">
<div class="line"><strong>fl</strong></div>
</div>
<div class="line-block">
<div class="line">[&lt;CF Field: air_temperature(time(1), pressure(23), latitude(160), longitude(320)) K&gt;,</div>
<div class="line-block">
<div class="line">&lt;CF Field: eastward_wind(time(1), pressure(23), latitude(160), longitude(320)) m s**-1&gt;,</div>
<div class="line">&lt;CF Field: northward_wind(time(1), pressure(23), latitude(160), longitude(320)) m s**-1&gt;,</div>
<div class="line">&lt;CF Field: geopotential(time(1), pressure(23), latitude(160), longitude(320)) m**2 s**-2&gt;]</div>
</div>
</div>
<p>In Python the number of the field starts at zero so to select the temperature we use:</p>
<div class="line-block">
<div class="line"><strong>g = fl[0]</strong></div>
</div>
<p>We could also have used</p>
<div class="line-block">
<div class="line"><strong>g = fl.select('air_temperature')[0]</strong></div>
</div>
<p>The select method on the field list always returns a list.  This list may have a number of fields spanning from zero upwards.  Again we use [0] to select the first element from this list.  g is now a field as denoted by the lack of square brackets around the item.</p>
<div class="line-block">
<div class="line"><strong>g</strong></div>
</div>
<p>&lt;CF Field: air_temperature(time(1), pressure(23), latitude(160), longitude(320)) K&gt;</p>
<p>If we wanted to select the geopotential height we could have used <strong>g = fl[3]</strong> or <strong>g = fl[-1]</strong>.  This normal Python notation for lists helps when selecting items from longer lists when using the index.</p>
</section>
<section id="looking-at-what-the-data-is-in-a-dimension">
<h3>Looking at what the data is in a dimension<a class="headerlink" href="#looking-at-what-the-data-is-in-a-dimension" title="Link to this heading">¶</a></h3>
<p>Reading in a new field</p>
<div class="line-block">
<div class="line"><strong>g = cf.read('cfplot_data/tas_A1.nc')[0]</strong></div>
<div class="line"><strong>g</strong></div>
</div>
<p>&lt;CF Field: air_temperature(time(1680), latitude(73), longitude(96)) K&gt;</p>
<p>To see what levels are available in the temperature data use:</p>
<div class="line-block">
<div class="line"><strong>g.construct('longitude').array</strong> - uses the standard_name attribute if it exists</div>
<div class="line"><strong>g.construct('long_name=longitude').array</strong> - uses the long_name attribute(in this case the long_name is also longitude)</div>
<div class="line"><strong>g.construct('X').array</strong> - uses the field X axis</div>
</div>
<div class="line-block">
<div class="line">array([  0.  ,   3.75,   7.5 ,  11.25,  15.  ,  18.75,  22.5 ,  26.25,</div>
<div class="line-block">
<div class="line-block">
<div class="line">30.  ,  33.75,  37.5 ,  41.25,  45.  ,  48.75,  52.5 ,  56.25,</div>
<div class="line">60.  ,  63.75,  67.5 ,  71.25,  75.  ,  78.75,  82.5 ,  86.25,</div>
<div class="line">90.  ,  93.75,  97.5 , 101.25, 105.  , 108.75, 112.5 , 116.25,</div>
<div class="line">120.  , 123.75, 127.5 , 131.25, 135.  , 138.75, 142.5 , 146.25,</div>
<div class="line">150.  , 153.75, 157.5 , 161.25, 165.  , 168.75, 172.5 , 176.25,</div>
<div class="line">180.  , 183.75, 187.5 , 191.25, 195.  , 198.75, 202.5 , 206.25,</div>
<div class="line">210.  , 213.75, 217.5 , 221.25, 225.  , 228.75, 232.5 , 236.25,</div>
</div>
<div class="line">240.  , 243.75, 247.5 , 251.25, 255.  , 258.75, 262.5 , 266.25,</div>
<div class="line-block">
<div class="line">270.  , 273.75, 277.5 , 281.25, 285.  , 288.75, 292.5 , 296.25,</div>
<div class="line">300.  , 303.75, 307.5 , 311.25, 315.  , 318.75, 322.5 , 326.25,</div>
<div class="line">330.  , 333.75, 337.5 , 341.25, 345.  , 348.75, 352.5 , 356.25])</div>
</div>
</div>
</div>
<p>The time dimension is slightly different and as before we can print off the numeric values for the time dimension.</p>
<div class="line-block">
<div class="line"><strong>g.construct('T').array</strong></div>
</div>
<div class="line-block">
<div class="line">array([1.5000e+01, 4.5000e+01, 7.5000e+01, ..., 5.0325e+04, 5.0355e+04,</div>
<div class="line-block">
<div class="line">5.0385e+04])</div>
</div>
</div>
<p>There is also an additional list for this translated into a date time object array</p>
<div class="line-block">
<div class="line"><strong>g.construct('T').dtarray</strong></div>
</div>
<div class="line-block">
<div class="line">array([cftime.Datetime360Day(1860, 1, 16, 0, 0, 0, 0, 2, 16),</div>
<div class="line-block">
<div class="line">cftime.Datetime360Day(1860, 2, 16, 0, 0, 0, 0, 4, 46),</div>
<div class="line">cftime.Datetime360Day(1860, 3, 16, 0, 0, 0, 0, 6, 76), ...,</div>
<div class="line">cftime.Datetime360Day(1999, 10, 16, 0, 0, 0, 0, 3, 286),</div>
<div class="line">cftime.Datetime360Day(1999, 11, 16, 0, 0, 0, 0, 5, 316),</div>
<div class="line">cftime.Datetime360Day(1999, 12, 16, 0, 0, 0, 0, 0, 346)],</div>
<div class="line">dtype=object)</div>
</div>
</div>
</section>
<section id="selecting-a-single-dimension-value">
<h3>Selecting a single dimension value<a class="headerlink" href="#selecting-a-single-dimension-value" title="Link to this heading">¶</a></h3>
<p>In the case below we select the slice of data at longitude=0.0 with the subspace method.</p>
<div class="line-block">
<div class="line"><strong>g.subspace(longitude=0.0)</strong></div>
<div class="line"><strong>g.subspace(X=0.0)</strong></div>
<div class="line"><strong>g.subspace('long_name:longitude'=500)</strong></div>
</div>
<p>The field now has one longitude.</p>
<p>&lt;CF Field: air_temperature(time(1680), latitude(73), longitude(1)) K&gt;</p>
<p>Multiple subspaces can be made in the same line of code:</p>
<div class="line-block">
<div class="line"><strong>g.subspace(longitude=0.0, latitude=0.0)</strong></div>
</div>
<p>&lt;CF Field: air_temperature(time(1680), latitude(1), longitude(1)) K&gt;</p>
<p>To select on time either use the numeric value or use cf.dt as in the below example.</p>
<div class="line-block">
<div class="line"><strong>g.subspace(time=15.0)</strong></div>
<div class="line"><strong>g.subspace(time=cf.dt('1860-1-16'))</strong></div>
</div>
</section>
<section id="selecting-a-range-of-dimension-values">
<h3>Selecting a range of dimension values<a class="headerlink" href="#selecting-a-range-of-dimension-values" title="Link to this heading">¶</a></h3>
<p>To select a range of values use the cf.wi cf.wi construct</p>
<div class="line-block">
<div class="line"><strong>g.subspace(longitude=cf.wi(0, 60))</strong></div>
<div class="line"><strong>g.subspace(X=cf.wi(0, 60))</strong></div>
</div>
<div class="line-block">
<div class="line"><strong>g.subspace(T=cf.wi(cf.dt('1860-1-16'), cf.dt('1960-1-16')))</strong></div>
</div>
</section>
<section id="collapsing-a-dimension">
<h3>Collapsing a dimension<a class="headerlink" href="#collapsing-a-dimension" title="Link to this heading">¶</a></h3>
<p>The collapse method allows a variety of statistical operators to be applied over a dimension - mean, min, max, standard_deviation.  The most commonly used one is mean.</p>
<p>To do a time mean of the data</p>
<div class="line-block">
<div class="line"><strong>h = g.collapse('T: mean')</strong></div>
</div>
<p>&lt;CF Field: air_temperature(time(1), latitude(73), longitude(96)) K&gt;</p>
<p>This now has one time value placed in the middle  of the original time series.</p>
<div class="line-block">
<div class="line"><strong>h.coord('T').dtarray</strong></div>
<div class="line">array([cftime.Datetime360Day(1930, 1, 1, 0, 0, 0, 0, 1, 1)], dtype=object)</div>
</div>
<p>The bounds on the data are the minimum and maximum of the original data bounds.</p>
<div class="line-block">
<div class="line"><strong>h.coord('T').bounds.dtarray</strong></div>
<div class="line">array([[cftime.Datetime360Day(1860, 1, 1, 0, 0, 0, 0, 1, 1),</div>
<div class="line-block">
<div class="line">cftime.Datetime360Day(2000, 1, 1, 0, 0, 0, 0, 1, 1)]],</div>
<div class="line">dtype=object)</div>
</div>
</div>
<p>An area mean can be accomplished with a special area operator.  If the weights='area' is left off then the value is not weighted by area and would be an incorrect value.</p>
<div class="line-block">
<div class="line"><strong>area_mean = g.collapse('area: mean', weights='area')</strong></div>
<div class="line"><strong>area_mean</strong></div>
</div>
<p>&lt;CF Field: air_temperature(time(1680), latitude(1), longitude(1)) K&gt;</p>
</section>
</section>
<section id="appendix-b-passing-data-via-arrays">
<span id="appendixb"></span><h2>Appendix B - Passing data via arrays<a class="headerlink" href="#appendix-b-passing-data-via-arrays" title="Link to this heading">¶</a></h2>
<p>cf-plot can also make contour and vector plots by passing data arrays. In this example we read in a temperature field from a netCDF file and pass it to cf-plot for plotting.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span> <span class="k">as</span> <span class="n">ncfile</span>
<span class="n">nc</span> <span class="o">=</span> <span class="n">ncfile</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)</span>
<span class="n">lons</span><span class="o">=</span><span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][:]</span>
<span class="n">lats</span><span class="o">=</span><span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">][:]</span>
<span class="n">temp</span><span class="o">=</span><span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,:]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">temp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">lons</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">lats</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/guide5.png"><img alt="_images/guide5.png" src="_images/guide5.png" style="width: 507.52000000000004px; height: 389.48px;" /></a>
<p>The contouring routine doesn't know that the data passed is a map plot as the only information passed is data arrays. i.e. there is no metadata available to help cf-plot to know what type of plot is required.  The plot type can be explicitly set in this case with the <strong>ptype</strong> flag to <strong>cfp.con</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">temp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">lons</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">ptype</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/guide6.png"><img alt="_images/guide6.png" src="_images/guide6.png" style="width: 514.28px; height: 298.48px;" /></a>
<p>Other types of plot are:</p>
<div class="line-block">
<div class="line"><strong>ptype=2</strong> - latitude - height plot</div>
<div class="line"><strong>ptype=3</strong> - longitude - height plot</div>
<div class="line"><strong>ptype=4</strong> - longitude - time plot</div>
<div class="line"><strong>ptype=5</strong> - latitude - time plot</div>
<div class="line"><strong>ptype=6</strong> - rotated pole plot</div>
<div class="line"><strong>ptype=7</strong> - time - height plot</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>In the next example the atmosphere is upside down as cf-plot will plot data axes starting with the smallest value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span> <span class="k">as</span> <span class="n">ncfile</span>
<span class="n">nc</span> <span class="o">=</span> <span class="n">ncfile</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)</span>
<span class="n">lats</span><span class="o">=</span><span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][:]</span>
<span class="n">pressure</span><span class="o">=</span><span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">][:]</span>
<span class="n">u</span><span class="o">=</span><span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">][:,:,:]</span>
<span class="n">u_mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">u_mean</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">pressure</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/guide7.png"><img alt="_images/guide7.png" src="_images/guide7.png" style="width: 514.28px; height: 389.48px;" /></a>
<p>Adding <strong>ptype=4</strong> to the <strong>cfp.con</strong> allows cf-plot to recognise the data as having a pressure axis and plots the atmosphere the right way up.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">u_mean</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span> <span class="n">ptype</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/guide8.png"><img alt="_images/guide8.png" src="_images/guide8.png" style="width: 518.96px; height: 389.48px;" /></a>
</section>
<section id="appendix-c-map-projections-and-options">
<span id="appendixc"></span><h2>Appendix C - map projections and options<a class="headerlink" href="#appendix-c-map-projections-and-options" title="Link to this heading">¶</a></h2>
<p>The default map plotting projection is the cyclindrical equidistant
projection from -180 to 180 in longitude and -90 to 90 in latitude.
To change the map view in this projection to over the United Kingdom,
for example, you would use</p>
<div class="line-block">
<div class="line"><strong>mapset(lonmin=-6, lonmax=3, latmin=50, latmax=60)</strong></div>
<div class="line">or</div>
<div class="line"><strong>mapset(-6, 3, 50, 60)</strong></div>
</div>
<p>The limits are -360 to 720 in longitude so to look at the equatorial
Pacific you could use</p>
<div class="line-block">
<div class="line"><strong>mapset(lonmin=90, lonmax=300, latmin=-30, latmax=30)</strong></div>
<div class="line">or</div>
<div class="line"><strong>mapset(lonmin=-270, lonmax=-60, latmin=-30, latmax=30)</strong></div>
</div>
<p>Note that Cartopy forces the restriction that in the cyclindrical
equidistant projection a degrees of longitude has the same size as a
degree of latitude.</p>
<p>The <strong>proj</strong> parameter accepts <strong>'npstere'</strong> and <strong>'spstere'</strong> for northern
hemisphere or southern hemisphere polar stereographic projections.
In addition to these the <strong>boundinglat</strong> parameter sets the edge of the
viewable latitudes and <strong>lat_0</strong> sets the centre of desired map domain.</p>
<p>Additional map projections via proj are: <strong>ortho</strong>, <strong>merc</strong>, <strong>moll</strong>, <strong>robin</strong> and <strong>lcc</strong>, <strong>ukcp</strong>,
<strong>osgb</strong> and <strong>EuroPP</strong>.</p>
<a class="reference internal image-reference" href="_images/fig31.png"><img alt="_images/fig31.png" src="_images/fig31.png" style="width: 487.24px; height: 324.48px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ukcp_rcm_test.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;UKCP&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>cf-plot looks for auxiliary coordinates of longitude and latitude and uses them if found.  If they aren't present then cf-plot will generate the grid required using the <strong>projection_x_coordinate</strong> and <strong>projection_y_coordinate</strong> variables within the netCDF data file.  For a blockfill plot as below it uses the latter method and the supplied bounds.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>New <strong>cfp.setvars</strong> options affecting the grid plotting for the UKCP grid are:</p>
<div class="line-block">
<div class="line">grid=True - draw grid</div>
<div class="line">grid_spacing=1 - grid spacing in degrees</div>
<div class="line">grid_lons=None - grid longitudes</div>
<div class="line">grid_lats=None - grid latitudes</div>
<div class="line">grid_colour='grey' - grid colour</div>
<div class="line">grid_linestyle='--' - grid line style</div>
<div class="line">grid_thickness=1.0 - grid thickness</div>
</div>
<p>Here we change the plotted grid with <strong>grid_lons</strong> and <strong>grid_lats</strong> options to <strong>cfp.setvars</strong> and make a blockfill plot.</p>
<a class="reference internal image-reference" href="_images/fig32.png"><img alt="_images/fig32.png" src="_images/fig32.png" style="width: 487.24px; height: 324.48px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ukcp_rcm_test.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;UKCP&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">setvars</span><span class="p">(</span><span class="n">grid_lons</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="n">grid_lats</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">+</span><span class="mi">49</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blockfill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<a class="reference internal image-reference" href="_images/fig33.png"><img alt="_images/fig33.png" src="_images/fig33.png" style="width: 487.76px; height: 324.48px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ukcp_rcm_test.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">levs</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;OSGB&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gpos</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;EuroPP&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<a class="reference internal image-reference" href="_images/fig34.png"><img alt="_images/fig34.png" src="_images/fig34.png" style="width: 487.24px; height: 325.0px;" /></a>
<p>Lambert conformal projections can now be cropped as in the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;lcc&#39;</span><span class="p">,</span> <span class="n">lonmin</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">latmin</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">latmax</span><span class="o">=</span><span class="mi">85</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<a class="reference internal image-reference" href="_images/fig35.png"><img alt="_images/fig35.png" src="_images/fig35.png" style="width: 488.28000000000003px; height: 310.96000000000004px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;moll&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig36.png"><img alt="_images/fig36.png" src="_images/fig36.png" style="width: 487.24px; height: 339.56px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;merc&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<a class="reference internal image-reference" href="_images/fig37.png"><img alt="_images/fig37.png" src="_images/fig37.png" style="width: 487.24px; height: 339.56px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<a class="reference internal image-reference" href="_images/fig38.png"><img alt="_images/fig38.png" src="_images/fig38.png" style="width: 488.28000000000003px; height: 318.76px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">mapset</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;robin&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block" id="appendixd">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</section>
<section id="appendix-d-modifying-data">
<h2>Appendix D - Modifying data<a class="headerlink" href="#appendix-d-modifying-data" title="Link to this heading">¶</a></h2>
<p>For the list of <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#attribute-appendix">CF attributes</a> setting and changing can be done using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">field</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;new_name&#39;</span>
</pre></div>
</div>
<p>This method works for adding in information to the field</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;new_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>There are also corresponding get_property and del_property methods</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">del_property</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="example-1-adding-a-standard-name-to-a-field-that-doesn-t-have-one">
<h3>Example 1 - adding a standard_name to a field that doesn't have one<a class="headerlink" href="#example-1-adding-a-standard-name-to-a-field-that-doesn-t-have-one" title="Link to this heading">¶</a></h3>
<p>In this case we have a field with a long_name but no standard_name</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/data1.nc&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">f</span>
</pre></div>
</div>
<p>&lt;CF Field: long_name=Potential vorticity(time(1), pressure(23), latitude(160), longitude(320)) K m**2 kg**-1 s**-1&gt;</p>
<p>Setting the standard_name is done with the standard_name method to the field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;ertel_potential_vorticity&#39;</span>
<span class="n">f</span>
</pre></div>
</div>
<p>&lt;CF Field: ertel_potential_vorticity(time(1), pressure(23), latitude(160), longitude(320)) K m**2 kg**-1 s**-1&gt;</p>
<p>and write out the new data to a file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;newdata.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-2-change-the-field-data-to-something-else">
<h3>Example 2 - change the field data to something else<a class="headerlink" href="#example-2-change-the-field-data-to-something-else" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/data1.nc&#39;</span><span class="p">)[</span><span class="mi">7</span><span class="p">]</span>
<span class="n">f</span>
</pre></div>
</div>
<p>&lt;CF Field: eastward_wind(time(1), pressure(23), latitude(160), longitude(320)) m s**-1&gt;</p>
<p>Next we put the numpy array of the data into a variable called data.  In this example we add 20 to all values we insert this back
into the field.  Using this method it is easy to modify certain parts of the data to change while leaving the rest as it was.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">array</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">+</span> <span class="mi">20</span>
<span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">data</span>
</pre></div>
</div>
<p>We could have just used the simpler notation of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">+=</span> <span class="mi">20</span>
</pre></div>
</div>
<p>and achieved the same effect.</p>
<p>We need to be aware of the valid_min and valid_max values here as we have modified the data.
For the original data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">valid_min</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">valid_max</span>
<span class="n">f</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">f</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<p>(-73.41583, 116.50885)
(&lt;CF Data(): -73.41583251953125 m s**-1&gt;, &lt;CF Data(): 116.50885009765625 m s**-1&gt;)</p>
<p>After we have changed the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">valid_min</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">valid_max</span>
<span class="n">f</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">f</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<p>(-73.41583, 116.50885)
(&lt;CF Data(): -53.41583251953125 m s**-1&gt;, &lt;CF Data(): 136.50885009765625 m s**-1&gt;)</p>
<p>Now we need to add 20 to the valid_min and valid_max:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">valid_min</span> <span class="o">+=</span> <span class="mi">20</span>
<span class="n">f</span><span class="o">.</span><span class="n">valid_max</span> <span class="o">+=</span> <span class="mi">20</span>
<span class="n">f</span><span class="o">.</span><span class="n">valid_min</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">valid_max</span>
</pre></div>
</div>
<p>(-53.41583251953125, 136.50885009765625)</p>
<p>Now when the data is written out it is correct.</p>
</section>
<section id="example-3-data-with-an-incorrect-valid-min-valid-max">
<h3>Example 3 - Data with an incorrect valid_min / valid_max<a class="headerlink" href="#example-3-data-with-an-incorrect-valid-min-valid-max" title="Link to this heading">¶</a></h3>
<p>Sometimes data has an invalid valid_min or valid_max due to a data creation mistake or processing error.</p>
<p>Here we make some sample data where the maximum of the data is greater than the valid_max parameter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/data1.nc&#39;</span><span class="p">)[</span><span class="mi">7</span><span class="p">]</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">g</span> <span class="o">+=</span> <span class="mi">60</span>

<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">valid_max</span><span class="p">)</span>
</pre></div>
</div>
<p>160.60183715820312 m s**-1 116.50885</p>
<p>When writing out the data we get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;data_incorrect.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>WARNING: &lt;CF Field: eastward_wind(time(1), pressure(1), latitude(160), longitude(320)) m s**-1&gt; has data values written to data_incorrect.nc that are strictly greater than the valid maximum defined by the valid_max property: 116.50885009765625. Set warn_valid=False to remove warning.</p>
<p>On reading in the data again by default we get no warning that the data could be compromised.  When we plot the data however we readily see that the jet stream has missing data and isn't plotted as we would expect.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;data_incorrect.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/data_incorrect1.png"><img alt="_images/data_incorrect1.png" src="_images/data_incorrect1.png" style="width: 514.28px; height: 309.92px;" /></a>
<p>To turn on the warning in the <strong>cf.read</strong> command use <strong>warn_valid=True</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;data_incorrect.nc&#39;</span><span class="p">,</span> <span class="n">warn_valid</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>WARNING: &lt;CF Field: eastward_wind(time(1), pressure(1), latitude(160), longitude(320)) m s**-1&gt; has  valid_max, valid_min properties. Set warn_valid=False to suppress warning.</p>
<p>We can read in the data ignoring the masking implied by valid_min and valid_max using the <strong>mask=False</strong> parameter.
See <a class="reference external" href="https://ncas-cms.github.io/cf-python/tutorial.html#data-mask">https://ncas-cms.github.io/cf-python/tutorial.html#data-mask</a> for more details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;data_incorrect.nc&#39;</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">con</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
<p>Now the data plots as we expect and we can change the data valid_min or valid_max as in the second example above.</p>
<a class="reference internal image-reference" href="_images/data_incorrect2.png"><img alt="_images/data_incorrect2.png" src="_images/data_incorrect2.png" style="width: 514.28px; height: 309.92px;" /></a>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<h3><a href="index.html">Homepage</a><p></h3>
<h5><a href="gallery.html">Gallery</a><p></h5>
<h5><a href="user_guide.html">User Guide</a><p></h5>
<h5><a href="training.html">Training material</a><p></h5>
<h5><a href="routines.html">Routines</a><p></h5>
<h5><a href="internal_routines.html">Routines - internal</a><p></h5>
<h5><a href="advanced.html">Advanced Use</a><p></h5>
<h5><a href="versions.html">Versions</a><p></h5>
<h5><a href="issues.html">Issues</a><p></h5>
<h5><a href="download.html">Download/Install</a><p></h5>
<h5><a href="license.html">License</a><p></h5>
<h5><a href="older_documentation.html">Older documentation</a><p></h5>
<h5><a href="search.html">Search</a><p></h5>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">cf-plot 3.3.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">cf-plot user guide</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Sadie Bartholomew.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>