<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Graphs &#8212; cf-plot 3.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=97decc96" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    
    <script src="_static/documentation_options.js?v=3eb8911e"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">cf-plot 3.3.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Graphs</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="graphs">
<span id="id1"></span><h1>Graphs<a class="headerlink" href="#graphs" title="Link to this heading">¶</a></h1>
<section id="example-27-graph-plot">
<h2>Example 27 - graph plot<a class="headerlink" href="#example-27-graph-plot" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="_images/fig27.png"><img alt="_images/fig27.png" src="_images/fig27.png" style="width: 436.92px; height: 338.36px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">g</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: mean&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>\
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Zonal mean zonal wind at 100mb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Other valid markers are:</p>
<div class="line-block">
<div class="line">'.'        point</div>
<div class="line">','        pixel</div>
<div class="line">'o'        circle</div>
<div class="line">'v'        triangle_down</div>
<div class="line">'^'        triangle_up</div>
<div class="line">'&lt;'        triangle_left</div>
<div class="line">'&gt;'        triangle_right</div>
<div class="line">'1'        tri_down</div>
<div class="line">'2'        tri_up</div>
<div class="line">'3'        tri_left</div>
<div class="line">'4'        tri_right</div>
<div class="line">'8'        octagon</div>
<div class="line">'s'        square</div>
<div class="line">'p'        pentagon</div>
<div class="line">'*'        star</div>
<div class="line">'h'        hexagon1</div>
<div class="line">'H'        hexagon2</div>
<div class="line">'+'        plus</div>
<div class="line">'x'        x</div>
<div class="line">'D'        diamond</div>
<div class="line">'d'        thin_diamond</div>
</div>
</section>
<section id="example-28-line-and-legend-plot">
<h2>Example 28 - Line and legend plot<a class="headerlink" href="#example-28-line-and-legend-plot" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="_images/fig28.png"><img alt="_images/fig28.png" src="_images/fig28.png" style="width: 443.52px; height: 338.36px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">g</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: mean&#39;</span><span class="p">)</span>
<span class="n">xticks</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">90</span><span class="p">]</span>
<span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;90S&#39;</span><span class="p">,</span><span class="s1">&#39;75S&#39;</span><span class="p">,</span><span class="s1">&#39;60S&#39;</span><span class="p">,</span><span class="s1">&#39;45S&#39;</span><span class="p">,</span><span class="s1">&#39;30S&#39;</span><span class="p">,</span><span class="s1">&#39;15S&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;15N&#39;</span><span class="p">,</span><span class="s1">&#39;30N&#39;</span><span class="p">,</span><span class="s1">&#39;45N&#39;</span><span class="p">,</span><span class="s1">&#39;60N&#39;</span><span class="p">,</span><span class="s1">&#39;75N&#39;</span><span class="p">,</span><span class="s1">&#39;90N&#39;</span><span class="p">]</span>
<span class="n">xpts</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">]</span>
<span class="n">ypts</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">]</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gset</span><span class="p">(</span><span class="n">xmin</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">()</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>\
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Zonal mean zonal wind&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;100mb&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>\
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;200mb&#39;</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticklabels</span><span class="p">,</span>\
             <span class="n">legend_location</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">plotvars</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpts</span><span class="p">,</span><span class="n">ypts</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">plotvars</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Region of interest&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">When making a multiple line plot:</div>
<div class="line">a) Set the axis limits if required with cfp.gset before plotting the lines.  Using cfp.gset after the last line has been plotted may give unexpected axis limits and / or labelling.  This is a feature of Matplotlib.</div>
<div class="line">b) The last call to lineplot is the one that any of the above</div>
<div class="line-block">
<div class="line">axis overrides should be placed in.</div>
</div>
<div class="line">c) All calls to lineplot with the label attribute will appear in the legend.</div>
</div>
<p>The cfp.plotvars.plot object contains the Matplotlib plot and will accept normal Matplotlib plotting commands.  As an example of this the following code within a cfp.gopen() cfp.gclose() construct will make a legend that is independent of any previously made lines and attached labels.</p>
<div class="line-block">
<div class="line">import matplotlib.lines as mlines</div>
<div class="line">green_line = mlines.Line2D([], [], color='green',  label='green')</div>
<div class="line">black_line = mlines.Line2D([], [], color='black', ls='--' ,  label='black dashed')</div>
<div class="line">cfp.plotvars.plot.legend(handles=[green_line, black_line])</div>
</div>
<p>Valid locations for the legend_location keyword are:</p>
<div class="line-block">
<div class="line">'right'</div>
<div class="line">'center left'</div>
<div class="line">'upper right'</div>
<div class="line">'lower right'</div>
<div class="line">'best'</div>
<div class="line">'center'</div>
<div class="line">'lower left'</div>
<div class="line">'center right'</div>
<div class="line">'upper left'</div>
<div class="line">'upper center'</div>
<div class="line">'lower center'</div>
</div>
<p>When making a call to lineplot the following parameters overide any predefined CF defaults:</p>
<div class="line-block">
<div class="line">title=None - plot title</div>
<div class="line">xunits=None - x units</div>
<div class="line">yunits=None - y units</div>
<div class="line">xname=None - x name</div>
<div class="line">yname=None - y name</div>
<div class="line">xticks=None - x ticks</div>
<div class="line">xticklabels=None - x tick labels</div>
<div class="line">yticks=None - y ticks</div>
<div class="line">yticklabels - y tick labels</div>
</div>
</section>
<section id="example-29-global-average-annual-temperature">
<h2>Example 29 - Global average annual temperature<a class="headerlink" href="#example-29-global-average-annual-temperature" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="_images/fig29.png"><img alt="_images/fig29.png" src="_images/fig29.png" style="width: 514.8px; height: 365.2px;" /></a>
<p>In this example we subset a time data series of global temperature, area mean the data, convert to Celsius and plot a linegraph.</p>
<p>When using gset to set the limits on the plotting axes and a time axis pass time strings to give the limits i.e.
cfp.gset(xmin = '1980-1-1', xmax = '1990-1-1', ymin = 285, ymax = 295)</p>
<p>The correct date format is 'YYYY-MM-DD' or 'YYYY-MM-DD HH:MM:SS' - anything else will give unexpected results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/tas_A1.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">temp</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">wi</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="s1">&#39;1900-01-01&#39;</span><span class="p">),</span> <span class="n">cf</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="s1">&#39;1980-01-01&#39;</span><span class="p">)))</span>
<span class="n">temp_annual</span><span class="o">=</span><span class="n">temp</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;T: mean&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">Y</span><span class="p">())</span>
<span class="n">temp_annual_global</span><span class="o">=</span><span class="n">temp_annual</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;area: mean&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="n">temp_annual_global</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Celsius&#39;</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">temp_annual_global</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Global average annual temperature&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-30-two-axis-plotting">
<h2>Example 30 - Two axis plotting<a class="headerlink" href="#example-30-two-axis-plotting" title="Link to this heading">¶</a></h2>
<a class="reference internal image-reference" href="_images/fig30.png"><img alt="_images/fig30.png" src="_images/fig30.png" style="width: 448.8px; height: 356.84px;" /></a>
<p>In this example we plot two x-axes, one with zonal mean zonal wind data and one with temperature data.  Somewhat confusingly
the option for a twin x-axis is twiny=True.  This is a Matplotlib keyword which has been adopted within the cf-plot code.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf</span>
<span class="kn">import</span> <span class="nn">cfplot</span> <span class="k">as</span> <span class="nn">cfp</span>
<span class="n">tol</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">RTOL</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">f</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">u</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: mean&#39;</span><span class="p">)</span>
<span class="n">u1</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Y</span><span class="o">=-</span><span class="mf">61.12099075</span><span class="p">)</span>
<span class="n">u2</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Y</span><span class="o">=</span><span class="mf">0.56074494</span><span class="p">)</span>

<span class="n">g</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;cfplot_data/ggap.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">collapse</span><span class="p">(</span><span class="s1">&#39;X: mean&#39;</span><span class="p">)</span>
<span class="n">t1</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Y</span><span class="o">=-</span><span class="mf">61.12099075</span><span class="p">)</span>
<span class="n">t2</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">subspace</span><span class="p">(</span><span class="n">Y</span><span class="o">=</span><span class="mf">0.56074494</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gopen</span><span class="p">()</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">gset</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">u2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gset</span><span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">twiny</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">cfp</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="n">cfp</span><span class="o">.</span><span class="n">gclose</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<h3><a href="index.html">Homepage</a><p></h3>
<h5><a href="gallery.html">Gallery</a><p></h5>
<h5><a href="user_guide.html">User Guide</a><p></h5>
<h5><a href="training.html">Training material</a><p></h5>
<h5><a href="routines.html">Routines</a><p></h5>
<h5><a href="internal_routines.html">Routines - internal</a><p></h5>
<h5><a href="advanced.html">Advanced Use</a><p></h5>
<h5><a href="versions.html">Versions</a><p></h5>
<h5><a href="issues.html">Issues</a><p></h5>
<h5><a href="download.html">Download/Install</a><p></h5>
<h5><a href="license.html">License</a><p></h5>
<h5><a href="older_documentation.html">Older documentation</a><p></h5>
<h5><a href="search.html">Search</a><p></h5>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">cf-plot 3.3.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Graphs</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Sadie Bartholomew.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>